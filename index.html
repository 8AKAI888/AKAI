<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="AKAI VERITAS â€” AI-powered murder mystery party kit generator. Create unique, printable mystery games in 60 seconds. 6 cinematic themes, 2-20 players.">
<meta name="keywords" content="murder mystery party, mystery game kit, AI party game, dinner party game, murder mystery generator">
<meta name="author" content="AKAI VERITAS">
<meta name="robots" content="index, follow">
<meta property="og:title" content="AKAI VERITAS â€” Every Party Deserves A Murder">
<meta property="og:description" content="AI-powered murder mystery party kits. Unique stories, custom characters, printable props. Ready in 60 seconds.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://akai-veritas.app">
<meta name="twitter:card" content="summary_large_image">
<title>AKAI VERITAS â€” AI Murder Mystery Party Kit Generator</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Security Headers -->
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="DENY">
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://fonts.gstatic.com https://js.stripe.com https://www.paypal.com https://cdnjs.cloudflare.com; img-src 'self' data: blob: https:; connect-src 'self' https://api.stripe.com https://api.anthropic.com;">
<meta name="referrer" content="strict-origin-when-cross-origin">

<!-- Copyright Protection -->
<meta name="copyright" content="Â© 2026 AKAI VERITAS. All Rights Reserved.">

<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CRIMECRAFT â€” PRODUCTION CSS
   Design: Cinematic Noir Luxury
   Â© 2026 AKAI VERITAS. All Rights Reserved.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
  --gold: #C8A96E;
  --gold-light: #E8D5A8;
  --gold-dark: #8B7340;
  --blood: #8B2020;
  --blood-light: #C44040;
  --bg-deep: #08080A;
  --bg-card: #0E0E12;
  --bg-elevated: #141418;
  --bg-hover: #1A1A20;
  --text-primary: #F0EAE0;
  --text-secondary: #8A8070;
  --text-muted: #5A5248;
  --border: rgba(200,169,110,0.08);
  --border-hover: rgba(200,169,110,0.2);
  --font-display: 'Cormorant Garamond', Georgia, serif;
  --font-body: 'Outfit', system-ui, sans-serif;
  --radius: 12px;
  --radius-lg: 20px;
  --max-w: 1200px;
  --transition: 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

::selection { background: rgba(200,169,110,0.25); color: var(--gold-light); }

html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }

body {
  font-family: var(--font-body);
  background: var(--bg-deep);
  color: var(--text-primary);
  overflow-x: hidden;
  line-height: 1.6;
}

/* Disable text selection on protected content */
.no-select { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
.no-copy { pointer-events: none; }

/* Grain overlay */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 9998;
  opacity: 0.4;
}

a { color: var(--gold); text-decoration: none; transition: color var(--transition); }
a:hover { color: var(--gold-light); }

img { max-width: 100%; display: block; }

/* â”€â”€ UTILITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.container { max-width: var(--max-w); margin: 0 auto; padding: 0 24px; }
.section { padding: 120px 0; }
.section-label {
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--gold);
  display: block;
  margin-bottom: 16px;
}
.section-title {
  font-family: var(--font-display);
  font-size: clamp(36px, 5vw, 56px);
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.15;
  margin-bottom: 20px;
}
.section-title em { color: var(--gold); font-style: italic; }
.section-subtitle {
  font-size: 17px;
  color: var(--text-secondary);
  max-width: 560px;
  line-height: 1.7;
}
.text-center { text-align: center; }
.mx-auto { margin-left: auto; margin-right: auto; }

/* â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 16px 36px;
  font-family: var(--font-body);
  font-size: 15px;
  font-weight: 600;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: all var(--transition);
  text-decoration: none;
  line-height: 1;
  letter-spacing: 0.3px;
}
.btn-primary {
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  color: var(--bg-deep);
  box-shadow: 0 8px 40px rgba(200,169,110,0.25), inset 0 1px 0 rgba(255,255,255,0.15);
}
.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 50px rgba(200,169,110,0.35), inset 0 1px 0 rgba(255,255,255,0.2);
}
.btn-secondary {
  background: rgba(255,255,255,0.03);
  color: var(--gold);
  border: 1px solid var(--border-hover);
}
.btn-secondary:hover {
  background: rgba(200,169,110,0.06);
  border-color: var(--gold);
}
.btn-sm { padding: 12px 24px; font-size: 13px; }
.btn-lg { padding: 20px 48px; font-size: 17px; }

/* â”€â”€ NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  padding: 0 24px;
  transition: all 0.4s ease;
}
.nav.scrolled {
  background: rgba(8,8,10,0.92);
  backdrop-filter: blur(24px) saturate(1.2);
  border-bottom: 1px solid var(--border);
}
.nav-inner {
  max-width: var(--max-w);
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 76px;
}
.nav-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  text-decoration: none;
}
.nav-logo-icon { font-size: 26px; }
.nav-logo-text {
  font-family: var(--font-display);
  font-size: 24px;
  font-weight: 700;
  color: var(--gold);
  letter-spacing: 0.5px;
}
.nav-links {
  display: flex;
  align-items: center;
  gap: 36px;
  list-style: none;
}
.nav-links a {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-secondary);
  letter-spacing: 0.3px;
  transition: color var(--transition);
  position: relative;
}
.nav-links a:hover { color: var(--gold); }
.nav-links a::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 0;
  width: 0;
  height: 1px;
  background: var(--gold);
  transition: width var(--transition);
}
.nav-links a:hover::after { width: 100%; }
.nav-cta { margin-left: 12px; }

.nav-mobile-toggle {
  display: none;
  background: none;
  border: none;
  color: var(--gold);
  font-size: 24px;
  cursor: pointer;
}
.nav-mobile-menu {
  display: none;
  position: fixed;
  top: 76px;
  left: 0;
  right: 0;
  background: rgba(8,8,10,0.98);
  backdrop-filter: blur(24px);
  padding: 32px 24px;
  border-bottom: 1px solid var(--border);
}
.nav-mobile-menu.open { display: block; }
.nav-mobile-menu a {
  display: block;
  padding: 16px 0;
  font-size: 18px;
  color: var(--text-secondary);
  border-bottom: 1px solid var(--border);
}

/* â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 140px 24px 100px;
  position: relative;
  overflow: hidden;
}
.hero-bg {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse at 50% 20%, rgba(200,169,110,0.06) 0%, transparent 55%),
    radial-gradient(ellipse at 20% 80%, rgba(139,32,32,0.04) 0%, transparent 45%),
    radial-gradient(ellipse at 80% 60%, rgba(200,169,110,0.03) 0%, transparent 45%);
}
.hero-particles {
  position: absolute;
  inset: 0;
  overflow: hidden;
}
.hero-particle {
  position: absolute;
  width: 2px;
  height: 2px;
  background: rgba(200,169,110,0.4);
  border-radius: 50%;
  animation: particleFloat 6s ease-in-out infinite alternate;
}
@keyframes particleFloat {
  0% { transform: translateY(0) scale(1); opacity: 0.2; }
  100% { transform: translateY(-40px) scale(1.5); opacity: 0.6; }
}
.hero-content { position: relative; z-index: 1; max-width: 820px; }
.hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 22px;
  background: rgba(200,169,110,0.06);
  border: 1px solid rgba(200,169,110,0.15);
  border-radius: 100px;
  margin-bottom: 36px;
  backdrop-filter: blur(10px);
}
.hero-badge span {
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 2.5px;
  text-transform: uppercase;
  color: var(--gold);
}
.hero-title {
  font-family: var(--font-display);
  font-size: clamp(44px, 8vw, 88px);
  font-weight: 700;
  line-height: 1.05;
  margin-bottom: 28px;
  text-shadow: 0 4px 40px rgba(0,0,0,0.5);
}
.hero-title em {
  color: var(--gold);
  font-style: italic;
  display: inline-block;
  position: relative;
}
.hero-title em::after {
  content: '';
  position: absolute;
  bottom: 4px;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity: 0.4;
}
.hero-desc {
  font-size: clamp(16px, 2.2vw, 20px);
  color: var(--text-secondary);
  line-height: 1.75;
  max-width: 620px;
  margin: 0 auto 44px;
}
.hero-buttons {
  display: flex;
  gap: 16px;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 56px;
}
.hero-stats {
  display: flex;
  gap: 56px;
  justify-content: center;
  flex-wrap: wrap;
}
.hero-stat-value {
  font-family: var(--font-display);
  font-size: 32px;
  font-weight: 700;
  color: var(--gold);
}
.hero-stat-label {
  font-size: 13px;
  color: var(--text-muted);
  margin-top: 4px;
}
.hero-scroll {
  position: absolute;
  bottom: 36px;
  left: 50%;
  transform: translateX(-50%);
  animation: bounce 2.5s ease-in-out infinite;
}
.hero-scroll-mouse {
  width: 26px;
  height: 42px;
  border: 2px solid rgba(200,169,110,0.25);
  border-radius: 13px;
  display: flex;
  justify-content: center;
  padding-top: 8px;
}
.hero-scroll-dot {
  width: 3px;
  height: 8px;
  background: var(--gold);
  border-radius: 3px;
  animation: scrollDot 2.5s ease-in-out infinite;
}
@keyframes bounce { 0%,100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(8px); } }
@keyframes scrollDot { 0%,100% { opacity: 0.3; transform: translateY(0); } 50% { opacity: 1; transform: translateY(6px); } }

/* â”€â”€ SOCIAL PROOF BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.proof-bar {
  padding: 36px 0;
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}
.proof-bar-inner {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 40px;
  flex-wrap: wrap;
}
.proof-bar-label {
  font-size: 12px;
  color: var(--text-muted);
  letter-spacing: 2px;
  text-transform: uppercase;
}
.proof-bar-stars { color: #F59E0B; font-size: 16px; letter-spacing: 2px; }
.proof-bar-text { font-size: 14px; color: var(--text-secondary); }

/* â”€â”€ HOW IT WORKS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.steps-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 28px;
  margin-top: 64px;
}
.step-card {
  padding: 36px 28px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  transition: all var(--transition);
  position: relative;
  overflow: hidden;
}
.step-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity: 0;
  transition: opacity var(--transition);
}
.step-card:hover { border-color: var(--border-hover); transform: translateY(-4px); }
.step-card:hover::before { opacity: 1; }
.step-num {
  font-family: var(--font-display);
  font-size: 13px;
  color: rgba(200,169,110,0.25);
  font-weight: 700;
  letter-spacing: 2px;
}
.step-icon { font-size: 40px; margin: 16px 0 20px; }
.step-title {
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 12px;
}
.step-desc {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.7;
}

/* â”€â”€ THEMES SHOWCASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.themes-tabs {
  display: flex;
  gap: 8px;
  justify-content: center;
  flex-wrap: wrap;
  margin: 48px 0;
}
.theme-tab {
  padding: 12px 22px;
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border);
  border-radius: 10px;
  cursor: pointer;
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 500;
  color: var(--text-muted);
  transition: all var(--transition);
}
.theme-tab:hover { border-color: var(--border-hover); color: var(--text-secondary); }
.theme-tab.active {
  background: rgba(200,169,110,0.08);
  border-color: rgba(200,169,110,0.3);
  color: var(--gold);
}
.theme-display {
  border: 1px solid rgba(200,169,110,0.1);
  border-radius: var(--radius-lg);
  overflow: hidden;
  position: relative;
}
.theme-display-inner {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 48px;
  padding: 60px 52px;
  align-items: center;
}
.theme-meta-era {
  font-size: 12px;
  letter-spacing: 2.5px;
  text-transform: uppercase;
  font-weight: 600;
  margin-bottom: 8px;
}
.theme-meta-title {
  font-family: var(--font-display);
  font-size: 40px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 8px;
}
.theme-meta-tagline {
  font-family: var(--font-display);
  font-size: 18px;
  font-style: italic;
  color: rgba(240,234,224,0.45);
  line-height: 1.5;
  margin-bottom: 24px;
}
.theme-meta-desc {
  font-size: 15px;
  color: var(--text-secondary);
  line-height: 1.8;
  margin-bottom: 28px;
}
.theme-tags {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 32px;
}
.theme-tag {
  padding: 6px 14px;
  background: rgba(200,169,110,0.06);
  border: 1px solid rgba(200,169,110,0.12);
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
}
.theme-preview {
  background: rgba(0,0,0,0.35);
  border-radius: 16px;
  padding: 32px;
  border: 1px solid rgba(255,255,255,0.04);
  backdrop-filter: blur(10px);
}
.theme-preview-label {
  font-size: 11px;
  color: var(--text-muted);
  letter-spacing: 2px;
  text-transform: uppercase;
  margin-bottom: 20px;
}
.theme-preview-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 11px 0;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  font-size: 14px;
  color: var(--text-secondary);
}
.theme-preview-check { font-size: 13px; }

/* â”€â”€ KIT CONTENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.kit-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 64px;
}
.kit-item {
  padding: 32px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  transition: all var(--transition);
}
.kit-item:hover { border-color: var(--border-hover); }
.kit-item-icon { font-size: 32px; margin-bottom: 16px; }
.kit-item-title {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
}
.kit-item-desc {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.7;
}

/* â”€â”€ PRICING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.pricing-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 64px;
  align-items: stretch;
}
.price-card {
  padding: 44px 36px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  display: flex;
  flex-direction: column;
  position: relative;
  transition: all var(--transition);
}
.price-card:hover { border-color: var(--border-hover); }
.price-card.popular {
  background: rgba(200,169,110,0.03);
  border-color: rgba(200,169,110,0.2);
  transform: scale(1.03);
  box-shadow: 0 12px 60px rgba(200,169,110,0.08);
}
.price-badge {
  position: absolute;
  top: -13px;
  left: 50%;
  transform: translateX(-50%);
  padding: 6px 22px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  white-space: nowrap;
}
.price-badge.gold {
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  color: var(--bg-deep);
}
.price-badge.silver {
  background: rgba(255,255,255,0.08);
  color: var(--text-secondary);
  border: 1px solid rgba(255,255,255,0.1);
}
.price-name {
  font-size: 15px;
  font-weight: 600;
  color: var(--gold);
  letter-spacing: 0.5px;
}
.price-players {
  font-size: 13px;
  color: var(--text-muted);
  margin: 4px 0 24px;
}
.price-amount {
  display: flex;
  align-items: baseline;
  gap: 10px;
  margin-bottom: 8px;
}
.price-current {
  font-family: var(--font-display);
  font-size: 52px;
  font-weight: 700;
  color: var(--text-primary);
}
.price-original {
  font-size: 18px;
  color: var(--text-muted);
  text-decoration: line-through;
}
.price-desc {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.6;
  margin-bottom: 32px;
}
.price-features { flex: 1; margin-bottom: 32px; }
.price-feature {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
  font-size: 14px;
  color: var(--text-secondary);
}
.price-feature-check { color: var(--gold); font-size: 14px; }
.price-btn { width: 100%; justify-content: center; }

/* â”€â”€ REVIEWS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.reviews-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 64px;
}
.review-card {
  padding: 32px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
}
.review-stars { color: #F59E0B; font-size: 14px; letter-spacing: 2px; margin-bottom: 16px; }
.review-text {
  font-size: 15px;
  color: var(--text-secondary);
  line-height: 1.7;
  margin-bottom: 20px;
  font-style: italic;
}
.review-author { font-size: 14px; font-weight: 600; color: var(--text-primary); }
.review-location { font-size: 12px; color: var(--text-muted); margin-top: 2px; }

/* â”€â”€ FAQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.faq-list { max-width: 740px; margin: 48px auto 0; }
.faq-item {
  border-bottom: 1px solid var(--border);
  overflow: hidden;
}
.faq-question {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 24px 0;
  background: none;
  border: none;
  cursor: pointer;
  font-family: var(--font-display);
  font-size: 19px;
  font-weight: 600;
  color: var(--text-primary);
  text-align: left;
  transition: color var(--transition);
}
.faq-question:hover { color: var(--gold); }
.faq-icon {
  font-size: 20px;
  color: var(--gold);
  transition: transform 0.3s ease;
  flex-shrink: 0;
  margin-left: 16px;
}
.faq-item.open .faq-icon { transform: rotate(45deg); }
.faq-answer {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease, padding 0.4s ease;
}
.faq-item.open .faq-answer { max-height: 300px; }
.faq-answer-inner {
  padding: 0 0 24px;
  font-size: 15px;
  color: var(--text-secondary);
  line-height: 1.8;
}

/* â”€â”€ FINAL CTA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.final-cta {
  padding: 120px 24px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.final-cta-bg {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse at 50% 50%, rgba(200,169,110,0.08) 0%, transparent 60%),
    radial-gradient(ellipse at 30% 80%, rgba(139,32,32,0.04) 0%, transparent 40%);
}
.final-cta-content { position: relative; z-index: 1; }

/* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.footer {
  padding: 80px 0 40px;
  border-top: 1px solid var(--border);
}
.footer-grid {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 48px;
  margin-bottom: 60px;
}
.footer-brand-desc {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.7;
  margin-top: 16px;
  max-width: 300px;
}
.footer-heading {
  font-family: var(--font-display);
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 20px;
}
.footer-link {
  display: block;
  font-size: 14px;
  color: var(--text-secondary);
  padding: 6px 0;
  transition: color var(--transition);
}
.footer-link:hover { color: var(--gold); }
.footer-bottom {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 32px;
  border-top: 1px solid var(--border);
  flex-wrap: wrap;
  gap: 16px;
}
.footer-copyright {
  font-size: 13px;
  color: var(--text-muted);
}
.footer-legal {
  display: flex;
  gap: 24px;
}
.footer-legal a {
  font-size: 13px;
  color: var(--text-muted);
}

/* â”€â”€ COOKIE CONSENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cookie-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 9999;
  background: rgba(14,14,18,0.97);
  backdrop-filter: blur(24px);
  border-top: 1px solid var(--border-hover);
  padding: 24px;
  transform: translateY(100%);
  transition: transform 0.5s ease;
}
.cookie-bar.visible { transform: translateY(0); }
.cookie-inner {
  max-width: var(--max-w);
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 24px;
  flex-wrap: wrap;
}
.cookie-text {
  flex: 1;
  min-width: 280px;
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.6;
}
.cookie-text a { text-decoration: underline; }
.cookie-buttons { display: flex; gap: 10px; flex-shrink: 0; }

/* â”€â”€ MODAL / OVERLAYS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-overlay {
  position: fixed;
  inset: 0;
  z-index: 2000;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }
.modal {
  background: var(--bg-elevated);
  border: 1px solid var(--border-hover);
  border-radius: var(--radius-lg);
  max-width: 640px;
  width: 100%;
  max-height: 85vh;
  overflow-y: auto;
  padding: 48px;
  position: relative;
}
.modal-close {
  position: absolute;
  top: 20px;
  right: 20px;
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 24px;
  cursor: pointer;
  transition: color var(--transition);
}
.modal-close:hover { color: var(--gold); }

/* â”€â”€ CONFIGURATION FLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.config-overlay {
  position: fixed;
  inset: 0;
  z-index: 3000;
  background: var(--bg-deep);
  overflow-y: auto;
  display: none;
}
.config-overlay.open { display: block; }
.config-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  background: rgba(8,8,10,0.95);
  backdrop-filter: blur(20px);
  z-index: 10;
}
.config-back {
  background: none;
  border: none;
  color: var(--text-secondary);
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  font-family: var(--font-body);
}
.config-back:hover { color: var(--gold); }
.config-steps {
  display: flex;
  gap: 8px;
  align-items: center;
}
.config-step-dot {
  width: 32px;
  height: 4px;
  border-radius: 2px;
  background: rgba(255,255,255,0.06);
  transition: background 0.3s ease;
}
.config-step-dot.active { background: var(--gold); }
.config-step-dot.done { background: rgba(200,169,110,0.4); }
.config-body {
  max-width: 680px;
  margin: 0 auto;
  padding: 60px 24px 120px;
}
.config-title {
  font-family: var(--font-display);
  font-size: 36px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
}
.config-subtitle {
  font-size: 16px;
  color: var(--text-secondary);
  margin-bottom: 40px;
}

/* Config form elements */
.form-group { margin-bottom: 24px; }
.form-label {
  display: block;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}
.form-input, .form-select {
  width: 100%;
  padding: 14px 18px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: var(--font-body);
  font-size: 15px;
  transition: border-color var(--transition);
  outline: none;
}
.form-input:focus, .form-select:focus { border-color: var(--gold); }
.form-input::placeholder { color: var(--text-muted); }
.form-select { cursor: pointer; -webkit-appearance: none; }
.form-select option { background: var(--bg-card); color: var(--text-primary); }

.player-row {
  display: grid;
  grid-template-columns: 1fr 120px 40px;
  gap: 12px;
  align-items: center;
  margin-bottom: 12px;
  animation: fadeIn 0.3s ease;
}
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.player-remove {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  background: rgba(139,32,32,0.1);
  border: 1px solid rgba(139,32,32,0.2);
  color: var(--blood-light);
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition);
}
.player-remove:hover { background: rgba(139,32,32,0.2); }
.add-player-btn {
  width: 100%;
  padding: 14px;
  background: rgba(200,169,110,0.04);
  border: 1px dashed rgba(200,169,110,0.2);
  border-radius: var(--radius);
  color: var(--gold);
  font-family: var(--font-body);
  font-size: 14px;
  cursor: pointer;
  transition: all var(--transition);
}
.add-player-btn:hover { background: rgba(200,169,110,0.08); border-color: var(--gold); }

/* Photo upload */
.photo-upload-area {
  border: 2px dashed rgba(200,169,110,0.15);
  border-radius: var(--radius-lg);
  padding: 40px;
  text-align: center;
  cursor: pointer;
  transition: all var(--transition);
  margin-top: 8px;
}
.photo-upload-area:hover { border-color: var(--gold); background: rgba(200,169,110,0.02); }
.photo-upload-icon { font-size: 36px; margin-bottom: 12px; }
.photo-upload-text { font-size: 14px; color: var(--text-secondary); }
.photo-upload-hint { font-size: 12px; color: var(--text-muted); margin-top: 6px; }

/* Format selector */
.format-options { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 8px; }
.format-option {
  padding: 24px;
  background: var(--bg-card);
  border: 2px solid var(--border);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all var(--transition);
  text-align: center;
}
.format-option:hover { border-color: var(--border-hover); }
.format-option.selected { border-color: var(--gold); background: rgba(200,169,110,0.04); }
.format-option-icon { font-size: 32px; margin-bottom: 8px; }
.format-option-title { font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
.format-option-desc { font-size: 13px; color: var(--text-secondary); }

/* Checkout summary */
.checkout-summary {
  background: var(--bg-card);
  border: 1px solid var(--border-hover);
  border-radius: var(--radius-lg);
  padding: 32px;
  margin-top: 32px;
}
.checkout-row {
  display: flex;
  justify-content: space-between;
  padding: 12px 0;
  font-size: 15px;
  color: var(--text-secondary);
  border-bottom: 1px solid var(--border);
}
.checkout-row:last-child { border: none; }
.checkout-total {
  font-family: var(--font-display);
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
}
.payment-methods {
  display: flex;
  gap: 12px;
  margin: 24px 0;
}
.payment-method {
  flex: 1;
  padding: 16px;
  background: var(--bg-elevated);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  text-align: center;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-secondary);
  transition: all var(--transition);
}
.payment-method:hover { border-color: var(--border-hover); }
.payment-method.selected { border-color: var(--gold); color: var(--gold); }

/* â”€â”€ ADMIN PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.admin-overlay {
  position: fixed;
  inset: 0;
  z-index: 5000;
  background: var(--bg-deep);
  overflow-y: auto;
  display: none;
}
.admin-overlay.open { display: block; }
.admin-header {
  padding: 20px 32px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--bg-card);
}
.admin-title { font-family: var(--font-display); font-size: 22px; color: var(--gold); }
.admin-body { max-width: 1000px; margin: 0 auto; padding: 40px 24px; }
.admin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 32px; }
.admin-card {
  padding: 28px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
}
.admin-card-title {
  font-family: var(--font-display);
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 16px;
}
.admin-stat {
  font-family: var(--font-display);
  font-size: 36px;
  font-weight: 700;
  color: var(--gold);
}
.admin-stat-label { font-size: 13px; color: var(--text-muted); margin-top: 4px; }
.admin-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px;
}
.admin-table th {
  text-align: left;
  padding: 10px 12px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  letter-spacing: 1px;
  text-transform: uppercase;
  border-bottom: 1px solid var(--border);
}
.admin-table td {
  padding: 12px;
  font-size: 14px;
  color: var(--text-secondary);
  border-bottom: 1px solid var(--border);
}

/* â”€â”€ LEGAL PAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.legal-overlay {
  position: fixed;
  inset: 0;
  z-index: 4000;
  background: var(--bg-deep);
  overflow-y: auto;
  display: none;
}
.legal-overlay.open { display: block; }
.legal-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 16px;
  position: sticky;
  top: 0;
  background: rgba(8,8,10,0.95);
  backdrop-filter: blur(20px);
  z-index: 10;
}
.legal-body {
  max-width: 740px;
  margin: 0 auto;
  padding: 60px 24px 120px;
}
.legal-body h1 {
  font-family: var(--font-display);
  font-size: 36px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
}
.legal-body .legal-date {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 40px;
}
.legal-body h2 {
  font-family: var(--font-display);
  font-size: 24px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 40px 0 16px;
}
.legal-body p {
  font-size: 15px;
  color: var(--text-secondary);
  line-height: 1.8;
  margin-bottom: 16px;
}
.legal-body ul {
  margin: 0 0 16px 24px;
  font-size: 15px;
  color: var(--text-secondary);
  line-height: 1.8;
}

/* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 900px) {
  .steps-grid { grid-template-columns: repeat(2, 1fr); }
  .theme-display-inner { grid-template-columns: 1fr; }
  .kit-grid { grid-template-columns: 1fr; }
  .pricing-grid { grid-template-columns: 1fr; }
  .price-card.popular { transform: none; }
  .reviews-grid { grid-template-columns: 1fr; }
  .footer-grid { grid-template-columns: 1fr 1fr; }
  .admin-grid { grid-template-columns: 1fr; }
  .nav-links { display: none; }
  .nav-mobile-toggle { display: block; }
  .hero-title { font-size: clamp(36px, 8vw, 60px); }
}
@media (max-width: 600px) {
  .steps-grid { grid-template-columns: 1fr; }
  .footer-grid { grid-template-columns: 1fr; }
  .hero-stats { gap: 32px; }
  .section { padding: 80px 0; }
  .format-options { grid-template-columns: 1fr; }
  .player-row { grid-template-columns: 1fr 100px 36px; }
}

/* â”€â”€ ANIMATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.fade-up {
  opacity: 0;
  transform: translateY(24px);
  transition: opacity 0.7s ease, transform 0.7s ease;
}
.fade-up.visible { opacity: 1; transform: translateY(0); }

/* Loading spinner */
.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(200,169,110,0.15);
  border-top-color: var(--gold);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin: 0 auto;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Generating animation */
.generating-overlay {
  position: fixed;
  inset: 0;
  z-index: 6000;
  background: rgba(8,8,10,0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 24px;
}
.generating-text {
  font-family: var(--font-display);
  font-size: 24px;
  color: var(--gold);
  animation: pulse 2s ease-in-out infinite;
}
@keyframes pulse { 0%,100% { opacity: 0.6; } 50% { opacity: 1; } }
.generating-bar {
  width: 300px;
  height: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  overflow: hidden;
}
.generating-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--gold), var(--gold-light));
  border-radius: 2px;
  animation: loadBar 8s ease-in-out forwards;
}
@keyframes loadBar { 0% { width: 0; } 30% { width: 40%; } 60% { width: 70%; } 90% { width: 90%; } 100% { width: 95%; } }

/* Right-click protection */
.protected { -webkit-touch-callout: none; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECURE ADMIN PANEL â€” AKAI VERITAS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.admin2-login-overlay{position:fixed;inset:0;z-index:9000;background:rgba(8,8,10,0.98);backdrop-filter:blur(24px);display:none;align-items:center;justify-content:center;}
.admin2-login-overlay.open{display:flex;}
.admin2-login-box{background:var(--bg-elevated);border:1px solid var(--border-hover);border-radius:var(--radius-lg);padding:52px 44px;width:100%;max-width:420px;position:relative;}
.admin2-login-logo{font-family:var(--font-display);font-size:26px;font-weight:700;color:var(--gold);text-align:center;margin-bottom:8px;}
.admin2-login-sub{font-size:12px;color:var(--text-muted);text-align:center;letter-spacing:2px;text-transform:uppercase;margin-bottom:36px;}
.admin2-login-error{background:rgba(139,32,32,0.15);border:1px solid rgba(139,32,32,0.3);border-radius:var(--radius);padding:12px 16px;font-size:13px;color:#C44040;margin-bottom:20px;display:none;}
.admin2-login-error.visible{display:block;}
.admin2-lockout{background:rgba(139,32,32,0.1);border:1px solid rgba(139,32,32,0.25);border-radius:var(--radius);padding:16px;text-align:center;font-size:13px;color:#C44040;display:none;}
.admin2-lockout.visible{display:block;}

/* Main admin panel */
.admin2-panel{position:fixed;inset:0;z-index:8000;background:var(--bg-deep);overflow-y:auto;display:none;}
.admin2-panel.open{display:block;}
.admin2-header{padding:20px 32px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:var(--bg-card);position:sticky;top:0;z-index:10;}
.admin2-header-left{display:flex;align-items:center;gap:16px;}
.admin2-logo{font-family:var(--font-display);font-size:20px;color:var(--gold);font-weight:700;}
.admin2-badge{padding:4px 12px;background:rgba(200,169,110,0.1);border:1px solid rgba(200,169,110,0.25);border-radius:20px;font-size:11px;font-weight:700;letter-spacing:1.5px;color:var(--gold);text-transform:uppercase;}
.admin2-body{max-width:1100px;margin:0 auto;padding:40px 24px 80px;}
.admin2-section-title{font-family:var(--font-display);font-size:22px;font-weight:600;color:var(--text-primary);margin:40px 0 20px;padding-bottom:12px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
.admin2-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:32px;}
@media(max-width:700px){.admin2-grid{grid-template-columns:1fr;}}
.admin2-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px;}
.admin2-card-title{font-family:var(--font-display);font-size:17px;font-weight:600;color:var(--text-primary);margin-bottom:16px;display:flex;align-items:center;gap:8px;}
.admin2-stat{font-family:var(--font-display);font-size:38px;font-weight:700;color:var(--gold);}
.admin2-stat-label{font-size:12px;color:var(--text-muted);margin-top:4px;}
.admin2-key-row{display:flex;align-items:center;gap:10px;margin-top:10px;}
.admin2-key-input{flex:1;padding:12px 14px;background:var(--bg-deep);border:1px solid var(--border);border-radius:var(--radius);color:var(--text-primary);font-family:monospace;font-size:13px;outline:none;transition:border-color var(--transition);}
.admin2-key-input:focus{border-color:var(--gold);}
.admin2-key-status{display:flex;align-items:center;gap:6px;font-size:12px;margin-top:6px;}
.admin2-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.admin2-dot.ok{background:#4CAF50;box-shadow:0 0 6px rgba(76,175,80,0.5);}
.admin2-dot.err{background:#F44336;}
.admin2-dot.warn{background:#FFC107;}
.admin2-toggle-eye{background:none;border:1px solid var(--border);border-radius:8px;padding:10px 14px;color:var(--text-muted);cursor:pointer;font-size:14px;transition:all var(--transition);flex-shrink:0;}
.admin2-toggle-eye:hover{border-color:var(--gold);color:var(--gold);}
.admin2-save-row{display:flex;align-items:center;gap:12px;margin-top:20px;}
.admin2-saved-msg{font-size:12px;color:#4CAF50;display:none;}
.admin2-saved-msg.visible{display:inline;}
.admin2-table{width:100%;border-collapse:collapse;margin-top:12px;}
.admin2-table th{text-align:left;padding:10px 12px;font-size:11px;font-weight:700;color:var(--text-muted);letter-spacing:1.5px;text-transform:uppercase;border-bottom:1px solid var(--border);}
.admin2-table td{padding:12px;font-size:13px;color:var(--text-secondary);border-bottom:1px solid rgba(200,169,110,0.05);}
.admin2-status-pill{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700;}
.admin2-status-pill.ok{background:rgba(76,175,80,0.15);color:#4CAF50;}
.admin2-status-pill.err{background:rgba(244,67,54,0.15);color:#F44336;}
.admin2-status-pill.warn{background:rgba(255,193,7,0.15);color:#FFC107;}
.admin2-lgame-toggle{display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg-deep);border:1px solid var(--border);border-radius:var(--radius);margin-top:12px;}
.admin2-toggle-switch{position:relative;width:44px;height:24px;cursor:pointer;flex-shrink:0;}
.admin2-toggle-switch input{opacity:0;width:0;height:0;}
.admin2-toggle-slider{position:absolute;inset:0;background:#2a2a30;border-radius:12px;transition:.3s;}
.admin2-toggle-slider:before{content:'';position:absolute;width:18px;height:18px;left:3px;bottom:3px;background:var(--text-muted);border-radius:50%;transition:.3s;}
.admin2-toggle-switch input:checked + .admin2-toggle-slider{background:var(--gold);}
.admin2-toggle-switch input:checked + .admin2-toggle-slider:before{transform:translateX(20px);background:var(--bg-deep);}
.admin2-pw-change{background:rgba(200,169,110,0.04);border:1px solid rgba(200,169,110,0.12);border-radius:var(--radius);padding:20px;margin-top:12px;}
.admin2-danger-zone{background:rgba(139,32,32,0.06);border:1px solid rgba(139,32,32,0.2);border-radius:var(--radius-lg);padding:24px;margin-top:20px;}
.admin2-danger-title{font-family:var(--font-display);font-size:16px;color:#C44040;margin-bottom:12px;display:flex;align-items:center;gap:8px;}

/* â•â•â• LOCAL GAME PUBLIC SECTION â•â•â• */
.localgame-hero{text-align:center;padding:80px 24px 60px;position:relative;overflow:hidden;}
.localgame-hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 30%,rgba(139,32,32,0.10) 0%,transparent 60%);pointer-events:none;}
.localgame-badge{display:inline-flex;align-items:center;gap:8px;padding:8px 22px;background:rgba(139,32,32,0.10);border:1px solid rgba(139,32,32,0.30);border-radius:100px;margin-bottom:28px;font-size:11px;font-weight:600;letter-spacing:2.5px;text-transform:uppercase;color:#C44040;}
.localgame-title{font-family:var(--font-display);font-size:clamp(36px,6vw,64px);font-weight:700;color:var(--text-primary);line-height:1.1;margin-bottom:20px;}
.localgame-title em{color:var(--gold);font-style:italic;}
.localgame-subtitle{font-size:17px;color:var(--text-secondary);max-width:560px;margin:0 auto 44px;line-height:1.7;}
.localgame-stats{display:flex;gap:48px;justify-content:center;flex-wrap:wrap;margin-bottom:48px;}
.localgame-stat-value{font-family:var(--font-display);font-size:28px;font-weight:700;color:var(--gold);}
.localgame-stat-label{font-size:12px;color:var(--text-muted);margin-top:4px;}
.localgame-grid{display:grid;grid-template-columns:1fr 420px;gap:32px;align-items:start;}
@media(max-width:900px){.localgame-grid{grid-template-columns:1fr;}}
.localgame-map-wrapper{border-radius:var(--radius-lg);overflow:hidden;border:1px solid rgba(200,169,110,0.15);position:relative;}
#localGameMap{width:100%;height:480px;background:#0e0e12;}
.localgame-map-overlay{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:rgba(8,8,10,0.85);backdrop-filter:blur(8px);gap:16px;transition:opacity 0.4s ease;}
.localgame-map-overlay.hidden{opacity:0;pointer-events:none;}
.localgame-map-icon{font-size:52px;}
.localgame-map-text{font-family:var(--font-display);font-size:22px;color:var(--text-primary);text-align:center;}
.localgame-map-hint{font-size:14px;color:var(--text-secondary);text-align:center;max-width:320px;}
.localgame-panel{display:flex;flex-direction:column;gap:20px;}
.localgame-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px;transition:border-color var(--transition);}
.localgame-card:hover{border-color:var(--border-hover);}
.localgame-card-title{font-family:var(--font-display);font-size:18px;font-weight:600;color:var(--text-primary);margin-bottom:16px;display:flex;align-items:center;gap:10px;}
.localgame-location-box{background:rgba(200,169,110,0.04);border:1px solid rgba(200,169,110,0.12);border-radius:var(--radius);padding:16px;margin-top:12px;}
.localgame-location-name{font-size:15px;font-weight:600;color:var(--text-primary);margin-bottom:4px;}
.localgame-location-coords{font-size:12px;color:var(--text-muted);font-family:monospace;}
.localgame-location-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:10px;}
.localgame-tag{padding:4px 10px;background:rgba(200,169,110,0.06);border:1px solid rgba(200,169,110,0.15);border-radius:20px;font-size:11px;color:var(--gold);}
.localgame-player-list{display:flex;flex-direction:column;gap:10px;margin-top:8px;}
.localgame-player-item{display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--bg-elevated);border:1px solid var(--border);border-radius:var(--radius);font-size:14px;color:var(--text-secondary);}
.localgame-player-dot{width:8px;height:8px;border-radius:50%;background:var(--gold);flex-shrink:0;}
.localgame-story-output{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:32px;margin-top:32px;display:none;}
.localgame-story-output.visible{display:block;}
.localgame-story-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid var(--border);gap:20px;flex-wrap:wrap;}
.localgame-story-title{font-family:var(--font-display);font-size:28px;font-weight:700;color:var(--text-primary);}
.localgame-story-location-badge{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(139,32,32,0.1);border:1px solid rgba(139,32,32,0.25);border-radius:100px;font-size:12px;color:#C44040;font-weight:600;}
.localgame-story-body{font-size:15px;color:var(--text-secondary);line-height:1.85;}
.localgame-story-body h3{font-family:var(--font-display);font-size:20px;font-weight:600;color:var(--gold);margin:28px 0 12px;}
.localgame-story-body p{margin-bottom:16px;}
.localgame-clue-card{background:rgba(200,169,110,0.04);border:1px solid rgba(200,169,110,0.15);border-radius:var(--radius);padding:16px 20px;margin:12px 0;}
.localgame-clue-label{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:6px;}
.localgame-clue-text{font-size:14px;color:var(--text-secondary);line-height:1.6;}
.localgame-generate-btn{width:100%;justify-content:center;padding:18px;font-size:16px;}
.localgame-generate-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none!important;}
.localgame-share-box{background:var(--bg-elevated);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;display:flex;align-items:center;gap:12px;margin-top:12px;}
.localgame-share-link{flex:1;font-size:13px;color:var(--gold);font-family:monospace;word-break:break-all;}
.localgame-spinner{width:20px;height:20px;border:2px solid rgba(200,169,110,0.2);border-top-color:var(--gold);border-radius:50%;animation:spin 0.8s linear infinite;flex-shrink:0;}
.localgame-steps{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin:48px 0;}
@media(max-width:900px){.localgame-steps{grid-template-columns:repeat(2,1fr);}}
@media(max-width:600px){.localgame-steps{grid-template-columns:1fr;}}
.localgame-step{padding:24px 20px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);text-align:center;transition:all var(--transition);position:relative;overflow:hidden;}
.localgame-step::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);opacity:0;transition:opacity var(--transition);}
.localgame-step:hover{border-color:var(--border-hover);transform:translateY(-3px);}
.localgame-step:hover::before{opacity:1;}
.localgame-step-num{font-family:var(--font-display);font-size:11px;color:rgba(200,169,110,0.3);font-weight:700;letter-spacing:2px;margin-bottom:10px;}
.localgame-step-icon{font-size:32px;margin-bottom:12px;}
.localgame-step-title{font-family:var(--font-display);font-size:17px;font-weight:600;color:var(--text-primary);margin-bottom:8px;}
.localgame-step-desc{font-size:13px;color:var(--text-secondary);line-height:1.6;}
.localgame-disabled-notice{background:rgba(200,169,110,0.04);border:1px dashed rgba(200,169,110,0.2);border-radius:var(--radius-lg);padding:48px;text-align:center;display:none;}
.localgame-disabled-notice.visible{display:block;}

</style>
</head>
<body class="no-select protected" oncontextmenu="return false;">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NAVIGATION
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="nav" id="mainNav">
  <div class="nav-inner">
    <a href="#" class="nav-logo" onclick="showPage('home'); return false;">
      <span class="nav-logo-icon">ğŸ”ª</span>
      <span class="nav-logo-text">AKAI VERITAS</span>
    </a>
    <ul class="nav-links">
      <li><a href="#themes" onclick="scrollToSection('themes')">Themes</a></li>
      <li><a href="#how" onclick="scrollToSection('how')">How It Works</a></li>
      <li><a href="#pricing" onclick="scrollToSection('pricing')">Pricing</a></li>
      <li><a href="#faq" onclick="scrollToSection('faq')">FAQ</a></li>
<li id="lgNavLink" style="display:none;"><a href="#localgame" onclick="scrollToSection('localgame')" style="color:var(--gold);font-weight:600;">ğŸ”´ Local Game</a></li>
      <li><a href="#" class="btn btn-primary btn-sm nav-cta" onclick="openConfigurator(); return false;">Create Your Mystery</a></li>
    </ul>
    <button class="nav-mobile-toggle" onclick="toggleMobileMenu()">â˜°</button>
  </div>
  <div class="nav-mobile-menu" id="mobileMenu">
    <a href="#themes" onclick="scrollToSection('themes'); closeMobileMenu();">Themes</a>
    <a href="#how" onclick="scrollToSection('how'); closeMobileMenu();">How It Works</a>
    <a href="#pricing" onclick="scrollToSection('pricing'); closeMobileMenu();">Pricing</a>
    <a href="#faq" onclick="scrollToSection('faq'); closeMobileMenu();">FAQ</a>
    <a href="#" onclick="openConfigurator(); closeMobileMenu(); return false;" style="color:var(--gold);font-weight:600;">Create Your Mystery â†’</a>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN PAGE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="mainPage">

<!-- HERO -->
<section class="hero" id="hero">
  <div class="hero-bg"></div>
  <div class="hero-particles">
    <div class="hero-particle" style="left:12%;top:25%;animation-delay:0s;animation-duration:5s;"></div>
    <div class="hero-particle" style="left:28%;top:65%;animation-delay:1s;animation-duration:7s;"></div>
    <div class="hero-particle" style="left:55%;top:35%;animation-delay:2s;animation-duration:6s;"></div>
    <div class="hero-particle" style="left:72%;top:55%;animation-delay:0.5s;animation-duration:8s;"></div>
    <div class="hero-particle" style="left:88%;top:20%;animation-delay:3s;animation-duration:5.5s;"></div>
    <div class="hero-particle" style="left:40%;top:80%;animation-delay:1.5s;animation-duration:6.5s;"></div>
  </div>
  <div class="hero-content">
    <div class="hero-badge"><span>âœ¦ AI-Powered Murder Mystery Generator</span></div>
    <h1 class="hero-title">Every Party Deserves<br><em>A Murder</em></h1>
    <p class="hero-desc">Generate a completely unique murder mystery party kit in 60 seconds. Custom characters, printable props, digital gameplay â€” powered by AI, designed for an unforgettable night.</p>
    <div class="hero-buttons">
      <button class="btn btn-primary btn-lg" onclick="openConfigurator()">Create Your Mystery <span>â†’</span></button>
      <button class="btn btn-secondary btn-lg" onclick="scrollToSection('how')">See How It Works</button>
    </div>
    <div class="hero-stats">
      <div><div class="hero-stat-value" id="statCount">0</div><div class="hero-stat-label">Mysteries Created</div></div>
      <div><div class="hero-stat-value">~60s</div><div class="hero-stat-label">Generation Time</div></div>
      <div><div class="hero-stat-value">4.9 â˜…</div><div class="hero-stat-label">Average Rating</div></div>
    </div>
  </div>
  <div class="hero-scroll"><div class="hero-scroll-mouse"><div class="hero-scroll-dot"></div></div></div>
</section>

<!-- SOCIAL PROOF -->
<section class="proof-bar">
  <div class="container">
    <div class="proof-bar-inner">
      <span class="proof-bar-label">Trusted worldwide</span>
      <span class="proof-bar-stars">â˜…â˜…â˜…â˜…â˜…</span>
      <span class="proof-bar-text">4.9/5 from 2,400+ reviews</span>
      <span class="proof-bar-text">Â·</span>
      <span class="proof-bar-text">12,800+ kits generated</span>
      <span class="proof-bar-text">Â·</span>
      <span class="proof-bar-text">47 countries</span>
    </div>
  </div>
</section>

<!-- HOW IT WORKS -->
<section class="section" id="how">
  <div class="container text-center">
    <span class="section-label">How It Works</span>
    <h2 class="section-title">From Click to <em>Crime Scene</em></h2>
    <p class="section-subtitle mx-auto">Four simple steps to the party of a lifetime. No experience needed â€” we handle everything.</p>
    <div class="steps-grid">
      <div class="step-card fade-up">
        <div class="step-num">01</div>
        <div class="step-icon">ğŸ­</div>
        <div class="step-title">Choose Your Theme</div>
        <div class="step-desc">Pick from 6 cinematic settings â€” from a 1920s Orient Express to a Space Station in 2184.</div>
      </div>
      <div class="step-card fade-up" style="transition-delay:0.1s;">
        <div class="step-num">02</div>
        <div class="step-icon">ğŸ‘¥</div>
        <div class="step-title">Add Your Players</div>
        <div class="step-desc">Enter names and genders. Upload photos for AI portraits, or let us generate them.</div>
      </div>
      <div class="step-card fade-up" style="transition-delay:0.2s;">
        <div class="step-num">03</div>
        <div class="step-icon">âš¡</div>
        <div class="step-title">AI Creates Your Kit</div>
        <div class="step-desc">In ~60 seconds, our AI crafts a complete, unique mystery with characters, clues, and scripts.</div>
      </div>
      <div class="step-card fade-up" style="transition-delay:0.3s;">
        <div class="step-num">04</div>
        <div class="step-icon">ğŸ–¨ï¸</div>
        <div class="step-title">Print or Play Digital</div>
        <div class="step-desc">Get A4-ready PDFs for printing AND a digital version for phones. Both included.</div>
      </div>
    </div>
  </div>
</section>

<!-- THEMES SHOWCASE -->
<section class="section" id="themes">
  <div class="container text-center">
    <span class="section-label">Choose Your Setting</span>
    <h2 class="section-title">6 Cinematic <em>Worlds</em></h2>
    <p class="section-subtitle mx-auto">Each theme is a complete universe â€” with its own atmosphere, era, and deadly secrets.</p>

    <div class="themes-tabs" id="themeTabs"></div>
    <div class="theme-display" id="themeDisplay"></div>
  </div>
</section>

<!-- KIT CONTENTS -->
<section class="section" id="kit">
  <div class="container text-center">
    <span class="section-label">What's Inside</span>
    <h2 class="section-title">A Complete <em>Murder Kit</em></h2>
    <p class="section-subtitle mx-auto">Everything you need for an unforgettable evening. Just add guests.</p>
    <div class="kit-grid">
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ“‹</div><div class="kit-item-title">Host Guide</div><div class="kit-item-desc">Word-for-word scripts for every round, character assignment tips, timing guide, and troubleshooting. Even first-time hosts feel like pros.</div></div>
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ­</div><div class="kit-item-title">Character Sheets</div><div class="kit-item-desc">Unique 400-600 word backstories for each player, with round-by-round scripts, secrets, relationships, and roleplay tips.</div></div>
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ”</div><div class="kit-item-title">Clue Cards</div><div class="kit-item-desc">10-15 physical evidence cards â€” letters, reports, forensic findings. Written as in-universe documents. Print, cut, distribute.</div></div>
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ–¼ï¸</div><div class="kit-item-title">AI Portraits</div><div class="kit-item-desc">Upload player photos to get themed character portraits, or let our AI generate original art matching the story setting.</div></div>
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ“±</div><div class="kit-item-title">Digital Version</div><div class="kit-item-desc">Phone-optimized version â€” each player gets their sheet on their device. No printing needed. Same great mystery.</div></div>
      <div class="kit-item fade-up"><div class="kit-item-icon">ğŸ‰</div><div class="kit-item-title">Party Extras</div><div class="kit-item-desc">Themed Spotify playlist, cocktail/mocktail recipes, food suggestions, decoration ideas, and printable invitation templates.</div></div>
    </div>
  </div>
</section>

<!-- PRICING -->
<section class="section" id="pricing">
  <div class="container text-center">
    <span class="section-label">Pricing</span>
    <h2 class="section-title">One Price. <em>Complete Kit.</em></h2>
    <p class="section-subtitle mx-auto">No subscriptions. No hidden fees. Pay once, play forever. Both print + digital included.</p>
    <div class="pricing-grid" id="pricingGrid"></div>
  </div>
</section>

<!-- REVIEWS -->
<section class="section" id="reviews">
  <div class="container text-center">
    <span class="section-label">Reviews</span>
    <h2 class="section-title">What Hosts <em>Say</em></h2>
    <div class="reviews-grid" id="reviewsGrid"></div>
  </div>
</section>

<!-- APP DOWNLOAD -->
<section class="section" id="app" style="border-top:1px solid var(--border);border-bottom:1px solid var(--border);">
  <div class="container" style="display:grid;grid-template-columns:1fr 1fr;gap:64px;align-items:center;">
    <div>
      <span class="section-label">Mobile App</span>
      <h2 class="section-title" style="font-size:clamp(28px,4vw,40px);">Play From <em>Your Phone</em></h2>
      <p class="section-subtitle" style="margin-bottom:32px;">Download the AKAI VERITAS app for the smoothest digital experience. Each player opens their character on their own device. No printing needed.</p>
      <div style="display:flex;gap:16px;flex-wrap:wrap;">
        <button class="btn btn-primary btn-sm" onclick="alert('App Store coming soon! Use the web version for now.')">ğŸ“± App Store â€” Coming Soon</button>
        <button class="btn btn-secondary btn-sm" onclick="alert('Play Store coming soon! Use the web version for now.')">ğŸ¤– Google Play â€” Coming Soon</button>
      </div>
      <p style="font-size:13px;color:var(--text-muted);margin-top:16px;">Web version works perfectly on all phones in the meantime.</p>
    </div>
    <div style="text-align:center;">
      <div style="width:240px;height:420px;background:var(--bg-card);border:2px solid var(--border);border-radius:36px;margin:0 auto;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:16px;padding:32px;">
        <div style="font-size:48px;">ğŸ”ª</div>
        <div style="font-family:var(--font-display);font-size:24px;color:var(--gold);">AKAI VERITAS</div>
        <div style="font-size:13px;color:var(--text-muted);">Your mystery, your phone</div>
        <div style="width:80%;height:3px;background:var(--border);border-radius:2px;margin-top:auto;"></div>
      </div>
    </div>
  </div>
</section>

<!-- FAQ -->
<section class="section" id="faq">
  <div class="container text-center">
    <span class="section-label">FAQ</span>
    <h2 class="section-title">Common <em>Questions</em></h2>
    <div class="faq-list" id="faqList"></div>
  </div>
</section>

<!-- FINAL CTA -->
<section class="final-cta">
  <div class="final-cta-bg"></div>
  <div class="final-cta-content">
    <h2 class="section-title">Ready to Host a <em>Murder?</em></h2>
    <p class="section-subtitle mx-auto" style="margin-bottom:40px;">Join 12,800+ hosts who've created unforgettable mystery nights. Your unique kit is 60 seconds away.</p>
    <button class="btn btn-primary btn-lg" onclick="openConfigurator()">Create Your Mystery Now <span>â†’</span></button>
  </div>
</section>

<!-- FOOTER -->

<!-- â•â•â• LOCAL GAME PUBLIC SECTION â•â•â• -->
<section class="section" id="localgame" style="border-top:1px solid var(--border);display:none;" data-lg-section>
<div class="container">
  <div class="localgame-hero">
    <div class="localgame-badge">ğŸ”´ NEW FEATURE</div>
    <h2 class="localgame-title">Create a Mystery <em>In Your City</em></h2>
    <p class="localgame-subtitle">Share your location. Our AI scans real buildings, streets and local history to generate a murder mystery tied to your exact surroundings. Every game is 100% unique.</p>
    <div class="localgame-stats">
      <div><div class="localgame-stat-value">60s</div><div class="localgame-stat-label">Generation Time</div></div>
      <div><div class="localgame-stat-value">âˆ</div><div class="localgame-stat-label">Unique Locations</div></div>
      <div><div class="localgame-stat-value">2â€“10</div><div class="localgame-stat-label">Players</div></div>
      <div><div class="localgame-stat-value" id="lgBetaLabel">Beta</div><div class="localgame-stat-label" id="lgPriceLabel">Free Access</div></div>
    </div>
  </div>
  <div class="localgame-steps">
    <div class="localgame-step fade-up"><div class="localgame-step-num">01</div><div class="localgame-step-icon">ğŸ“</div><div class="localgame-step-title">Share Location</div><div class="localgame-step-desc">Click to share your GPS or pin any location on the map.</div></div>
    <div class="localgame-step fade-up" style="transition-delay:0.1s"><div class="localgame-step-num">02</div><div class="localgame-step-icon">ğŸ—ºï¸</div><div class="localgame-step-title">AI Scans Area</div><div class="localgame-step-desc">AI reads real places, streets and local history within 500m.</div></div>
    <div class="localgame-step fade-up" style="transition-delay:0.2s"><div class="localgame-step-num">03</div><div class="localgame-step-icon">âœï¸</div><div class="localgame-step-title">Story Generated</div><div class="localgame-step-desc">A complete murder mystery is written around your real surroundings.</div></div>
    <div class="localgame-step fade-up" style="transition-delay:0.3s"><div class="localgame-step-num">04</div><div class="localgame-step-icon">ğŸ­</div><div class="localgame-step-title">Play Live</div><div class="localgame-step-desc">Players get character sheets on phones and explore real locations.</div></div>
  </div>
  <div class="localgame-grid">
    <div>
      <div class="localgame-map-wrapper">
        <div id="localGameMap"></div>
        <div class="localgame-map-overlay" id="lgMapOverlay">
          <div class="localgame-map-icon">ğŸ—ºï¸</div>
          <div class="localgame-map-text">Loading map...</div>
          <div class="localgame-map-hint">Click "Use My Location" or search for a city below.</div>
        </div>
      </div>
      <div id="lgLocationBox" class="localgame-location-box" style="display:none;margin-top:16px;">
        <div class="localgame-location-name" id="lgLocationName">â€”</div>
        <div class="localgame-location-coords" id="lgLocationCoords">â€”</div>
        <div class="localgame-location-tags" id="lgLocationTags"></div>
      </div>
    </div>
    <div class="localgame-panel">
      <div class="localgame-card">
        <div class="localgame-card-title">ğŸ“ Location</div>
        <button class="btn btn-primary" id="lgLocBtn" onclick="lgGetLocation()" style="width:100%;justify-content:center;">ğŸ“ Use My Location</button>
        <div style="margin:14px 0;text-align:center;font-size:13px;color:var(--text-muted);">or search</div>
        <input type="text" class="form-input" id="lgSearchInput" placeholder="TrenÄÃ­n, Paris, Tokyo..." style="padding:12px 14px;" onkeydown="if(event.key==='Enter')lgSearchLocation()"/>
        <button class="btn btn-secondary btn-sm" onclick="lgSearchLocation()" style="width:100%;justify-content:center;margin-top:10px;">ğŸ” Search</button>
      </div>
      <div class="localgame-card">
        <div class="localgame-card-title">ğŸ‘¥ Players</div>
        <div class="localgame-player-list" id="lgPlayerList"></div>
        <button class="btn btn-secondary btn-sm" onclick="lgAddPlayer()" style="width:100%;justify-content:center;margin-top:12px;border-style:dashed;">+ Add Player</button>
      </div>
      <div class="localgame-card">
        <div class="localgame-card-title">ğŸ­ Story Style</div>
        <select class="form-select" id="lgGenre" style="padding:12px 14px;">
          <option value="noir">ğŸ” Classic Noir Detective</option>
          <option value="historical">ğŸ° Historical Mystery</option>
          <option value="modern">ğŸŒ† Modern Thriller</option>
          <option value="comedy">ğŸ˜‚ Comedy Whodunit</option>
          <option value="horror">ğŸ‘» Dark Horror</option>
          <option value="spy">ğŸ•µï¸ Spy Conspiracy</option>
        </select>
        <div style="margin-top:12px;">
          <label class="form-label">Duration</label>
          <select class="form-select" id="lgDuration" style="padding:12px 14px;">
            <option value="30">30 min â€” Quick</option>
            <option value="60" selected>60 min â€” Standard</option>
            <option value="120">2 hours â€” Full</option>
            <option value="180">3+ hours â€” Epic</option>
          </select>
        </div>
      </div>
      <button class="btn btn-primary localgame-generate-btn" id="lgGenerateBtn" onclick="lgGenerateGame()" disabled>
        <span id="lgGenerateBtnText">ğŸ“ Select Location First</span>
        <div class="localgame-spinner" id="lgSpinner" style="display:none;"></div>
      </button>
      <div class="localgame-card" id="lgShareCard" style="display:none;">
        <div class="localgame-card-title">ğŸ”— Share with Players</div>
        <div class="localgame-share-box">
          <span class="localgame-share-link" id="lgShareLink">â€”</span>
          <button class="btn btn-secondary btn-sm" onclick="lgCopyLink()">Copy</button>
        </div>
      </div>
    </div>
  </div>
  <div class="localgame-story-output" id="lgStoryOutput">
    <div class="localgame-story-header">
      <div>
        <div style="font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:8px;">âš¡ Generated Mystery</div>
        <div class="localgame-story-title" id="lgStoryTitle">â€”</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:10px;align-items:flex-end;">
        <div class="localgame-story-location-badge" id="lgStoryLocationBadge">ğŸ“ â€”</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn btn-secondary btn-sm" onclick="lgPrintStory()">ğŸ–¨ï¸ Print</button>
          <button class="btn btn-primary btn-sm" onclick="lgGenerateGame()">ğŸ”„ Regenerate</button>
        </div>
      </div>
    </div>
    <div class="localgame-story-body" id="lgStoryBody"></div>
  </div>
</div>
</section>

<footer class="footer">
  <div class="container">
    <div class="footer-grid">
      <div>
        <a href="#" class="nav-logo" onclick="scrollToSection('hero'); return false;" style="margin-bottom:0;">
          <span class="nav-logo-icon">ğŸ”ª</span>
          <span class="nav-logo-text">AKAI VERITAS</span>
        </a>
        <p class="footer-brand-desc">AI-powered murder mystery party kits. Every story is unique. Every party is unforgettable.</p>
        <p style="font-size:13px;color:var(--text-muted);margin-top:12px;">ğŸ“§ hello@akai-veritas.app</p>
      </div>
      <div>
        <div class="footer-heading">Product</div>
        <a href="#themes" class="footer-link" onclick="scrollToSection('themes')">Themes</a>
        <a href="#pricing" class="footer-link" onclick="scrollToSection('pricing')">Pricing</a>
        <a href="#kit" class="footer-link" onclick="scrollToSection('kit')">What's Included</a>
        <a href="#app" class="footer-link" onclick="scrollToSection('app')">Mobile App</a>
      </div>
      <div>
        <div class="footer-heading">Support</div>
        <a href="#faq" class="footer-link" onclick="scrollToSection('faq')">FAQ</a>
        <a href="#" class="footer-link" onclick="openLegal('contact'); return false;">Contact Us</a>
        <a href="#" class="footer-link" onclick="openLegal('refund'); return false;">Refund Policy</a>
      </div>
      <div>
        <div class="footer-heading">Legal</div>
        <a href="#" class="footer-link" onclick="openLegal('privacy'); return false;">Privacy Policy</a>
        <a href="#" class="footer-link" onclick="openLegal('terms'); return false;">Terms of Service</a>
        <a href="#" class="footer-link" onclick="openLegal('cookies'); return false;">Cookie Policy</a>
        <a href="#" class="footer-link" onclick="openLegal('gdpr'); return false;">GDPR</a>
      </div>
    </div>
    <div class="footer-bottom">
      <span class="footer-copyright">Â© 2026 AKAI VERITAS. All Rights Reserved. Protected by international copyright law.</span>
      <div class="footer-legal">
        <a href="#" onclick="openLegal('privacy'); return false;">Privacy</a>
        <a href="#" onclick="openLegal('terms'); return false;">Terms</a>
        <a href="#" onclick="openLegal('cookies'); return false;">Cookies</a>
      </div>
    </div>
  </div>
</footer>

</div><!-- /mainPage -->


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CONFIGURATOR OVERLAY
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="config-overlay" id="configOverlay">
  <div class="config-header">
    <button class="config-back" onclick="configBack()">â† Back</button>
    <a href="#" class="nav-logo" onclick="closeConfigurator(); return false;" style="position:absolute;left:50%;transform:translateX(-50%);">
      <span class="nav-logo-icon">ğŸ”ª</span>
      <span class="nav-logo-text">AKAI VERITAS</span>
    </a>
    <div class="config-steps" id="configSteps"></div>
  </div>
  <div class="config-body" id="configBody"></div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GENERATING OVERLAY
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="generatingOverlay" style="display:none;" class="generating-overlay">
  <div class="spinner" style="width:48px;height:48px;border-width:3px;"></div>
  <div class="generating-text" id="genText">Crafting your mystery...</div>
  <div class="generating-bar"><div class="generating-bar-fill"></div></div>
  <p style="font-size:14px;color:var(--text-muted);max-width:400px;text-align:center;margin-top:8px;" id="genSubtext">Our AI is writing unique characters, weaving clues, and designing your complete murder mystery kit.</p>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LEGAL OVERLAY
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="legal-overlay" id="legalOverlay">
  <div class="legal-header">
    <button class="config-back" onclick="closeLegal()">â† Back to AKAI VERITAS</button>
  </div>
  <div class="legal-body" id="legalBody"></div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADMIN PANEL
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="admin-overlay" id="adminOverlay">
  <div class="admin-header">
    <span class="admin-title">ğŸ”’ AKAI VERITAS Admin Panel</span>
    <button class="btn btn-secondary btn-sm" onclick="closeAdmin()">Close</button>
  </div>
  <div class="admin-body" id="adminBody"></div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     COOKIE CONSENT
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="cookie-bar" id="cookieBar">
  <div class="cookie-inner">
    <div class="cookie-text">
      ğŸª We use essential cookies for payments and site functionality, plus optional analytics to improve your experience. 
      <a href="#" onclick="openLegal('cookies'); return false;">Learn more</a>
    </div>
    <div class="cookie-buttons">
      <button class="btn btn-secondary btn-sm" onclick="acceptCookies('essential')">Essential Only</button>
      <button class="btn btn-primary btn-sm" onclick="acceptCookies('all')">Accept All</button>
    </div>
  </div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT â€” Complete Application Logic
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const THEMES = [
  { id:"orient-express", title:"The Last Crossing", era:"Orient Express, 1927", tagline:"The snow has stopped the train. But nothing can stop the truth.", emoji:"ğŸš‚", color:"#D4A574", bg:"linear-gradient(135deg,#1a0f00,#2d1810,#1a0f00)", desc:"A luxury train, a blizzard, and a dead industrialist. Six passengers with tangled histories. Art Deco elegance meets ruthless deduction.", tags:["1920s glamour","Locked-room","International intrigue"], diff:"Medium" },
  { id:"medieval-castle", title:"The King's Last Feast", era:"Castle Aldenmere, 1342", tagline:"The crown is heavy. The poison is light.", emoji:"ğŸ°", color:"#8B7355", bg:"linear-gradient(135deg,#0a0a08,#1a1810,#0a0a08)", desc:"A Midwinter Feast, a poisoned king, and six advisors hiding deadly secrets. Swords, crowns, and betrayal in the great hall.", tags:["Medieval intrigue","Royal court","Poison mystery"], diff:"Medium" },
  { id:"space-station", title:"Station Omega", era:"Europa Orbit, 2184", tagline:"In space, no one can hear you lie.", emoji:"ğŸš€", color:"#64B5F6", bg:"linear-gradient(135deg,#020617,#0a1628,#020617)", desc:"A dead scientist in an airlock. A corporate cover-up. Six crew members on a space station with nowhere to run.", tags:["Sci-fi thriller","Corporate conspiracy","Digital evidence"], diff:"Medium-Hard" },
  { id:"hollywood-1952", title:"Final Take", era:"Hollywood, 1952", tagline:"In Hollywood, everyone plays a part. Tonight, someone played theirs for keeps.", emoji:"ğŸ¬", color:"#E57373", bg:"linear-gradient(135deg,#1a0008,#2d0a15,#1a0008)", desc:"A wrap party, a dead mogul, and six suspects in the golden age of cinema. Glamour, scandal, and a killer in the dark.", tags:["Golden age glamour","Studio secrets","Film noir"], diff:"Medium" },
  { id:"pirate-ship", title:"The Captain's Gold", era:"Caribbean Sea, 1715", tagline:"Dead men tell no tales. But the living ones lie through their teeth.", emoji:"ğŸ´â€â˜ ï¸", color:"#FFD54F", bg:"linear-gradient(135deg,#001a1a,#002020,#001a1a)", desc:"A murdered captain, a missing treasure map, and six pirates in a hidden Caribbean cove. Mutiny, gold, and the hangman's noose.", tags:["Pirate adventure","Treasure hunt","High seas drama"], diff:"Medium" },
  { id:"vegas-1963", title:"Double Down", era:"Las Vegas, 1963", tagline:"The house always wins. Until tonight.", emoji:"ğŸ°", color:"#CE93D8", bg:"linear-gradient(135deg,#0d001a,#1a0033,#0d001a)", desc:"A casino owner dead in the high-roller suite. Mob connections, rigged games, and six suspects who all went all-in.", tags:["Rat Pack era","Mob intrigue","High-stakes gambling"], diff:"Medium" }
];

const PRICING = [
  { id:"couples", name:"Date Night", players:"2â€“3 players", range:"2-3", min:2, max:3, price:4.99, orig:9.99, desc:"Intimate mystery for two or three â€” the perfect twist on date night.", features:["2-3 player adapted story","45-90 min gameplay","Print A4 + digital phone","AI character portraits","Themed playlist & recipes"], badge:null, popular:false },
  { id:"party", name:"Party Kit", players:"3â€“8 players", range:"3-8", min:3, max:8, price:7.99, orig:14.99, desc:"The classic experience â€” ideal for dinner parties and game nights.", features:["3-8 unique characters","2-3 hour gameplay","Print A4 + digital phone","AI character portraits","Full host guide with scripts","Clue cards & evidence props","Invitation templates","Themed playlist & recipes"], badge:"Most Popular", popular:true },
  { id:"group", name:"Group Event", players:"8â€“20 players", range:"8-20", min:8, max:20, price:14.99, orig:29.99, desc:"Epic mystery for large groups â€” team building, birthdays, corporate events.", features:["8-20 unique characters","2-4 hour gameplay","Print A4 + digital phone","AI character portraits","Advanced host guide","Multiple subplot lines","Team worksheets & extras","Themed decoration guide"], badge:"Best Value", popular:false }
];

const REVIEWS = [
  { name:"Sarah M.", loc:"Austin, TX", stars:5, text:"We played The Last Crossing for my birthday. EVERYONE was in character within 10 minutes. The reveal had actual gasps." },
  { name:"James K.", loc:"London, UK", stars:5, text:"Used the Group Event kit for office team building. 16 people, zero awkward silences. Best team event we've ever done." },
  { name:"Mia & Tom", loc:"Sydney, AU", stars:5, text:"Date Night kit was PERFECT. We're not actors but the scripts made it easy. Laughed for two hours straight." },
  { name:"Elena R.", loc:"Berlin, DE", stars:5, text:"The AI portraits of our friends as 1920s characters were hilarious. Everyone kept theirs as souvenirs. Ordering again for New Year's." },
  { name:"David C.", loc:"Toronto, CA", stars:5, text:"I've bought mystery kits from Etsy before â€” same story every time. AKAI VERITAS was genuinely unique. Nobody saw the killer coming." },
  { name:"Anna P.", loc:"Bratislava, SK", stars:5, text:"VÃ½bornÃ½ zÃ¡Å¾itok! Hrali sme s priateÄ¾mi a bolo to Ãºplne unikÃ¡tne. The print quality was professional. OdporÃºÄam." }
];

const FAQS = [
  { q:"How does AKAI VERITAS work?", a:"Choose a theme, enter player names and genders, and our AI generates a completely unique murder mystery kit in ~60 seconds. Every story is different â€” unique characters, motives, clues, and plot twists tailored to your group." },
  { q:"What's included in every kit?", a:"Host Guide with word-for-word scripts, individual Character Sheets, physical Clue Cards, Accusation Sheets, dramatic Reveal Script, AI character portraits, themed playlist, cocktail/food recipes, and printable invitation templates." },
  { q:"Print or digital â€” what's the difference?", a:"You get BOTH. The Print version is optimized for A4 paper â€” just print and cut. The Digital version is designed for phones â€” each player opens their character on their own device. Same mystery, two formats." },
  { q:"Is every mystery truly unique?", a:"Yes. Our AI creates a brand new story every time â€” different victim, different murderer, different motives, different clues. Even if two groups pick the same theme, they get completely different mysteries." },
  { q:"What about the AI character portraits?", a:"Upload photos of your players and our AI creates themed character portraits (e.g., your friend as a 1920s aristocrat). No photos? The AI generates original character art based on the story." },
  { q:"How long does a game take?", a:"Date Night: 45-90 minutes. Party Kit: 2-3 hours. Group Event: 2-4 hours. The Host Guide includes timing suggestions for each round." },
  { q:"Can I get a refund?", a:"Absolutely. If you're not satisfied, contact us within 24 hours at hello@akai-veritas.app and we'll regenerate a new kit or issue a full refund. No questions asked." },
  { q:"Do I need any experience to host?", a:"None. The Host Guide tells you exactly what to say and when. We've had first-time hosts run perfect games. The characters do the heavy lifting." }
];

const LEGAL_CONTENT = {
  privacy: { title:"Privacy Policy", date:"Last updated: February 21, 2026", body:`<h2>1. Information We Collect</h2><p>When you use AKAI VERITAS, we collect: email address (for kit delivery), player names (for story generation), payment information (processed securely by Stripe/PayPal â€” we never store card details), uploaded photos (processed for AI portraits, deleted within 24 hours), and basic analytics data (page views, device type).</p><h2>2. How We Use Your Information</h2><p>We use your information to: generate and deliver your murder mystery kit, process payments, send order confirmations, improve our service, and comply with legal obligations. We never sell your data to third parties.</p><h2>3. Data Storage & Security</h2><p>Your data is stored on secure servers with encryption at rest and in transit. Uploaded photos are processed by AI and permanently deleted within 24 hours. Generated mystery kits are stored for 30 days for re-download purposes, then deleted.</p><h2>4. Third-Party Services</h2><p>We use: Stripe and PayPal (payment processing), Anthropic Claude API (story generation â€” no personal data sent), Vercel (hosting), and anonymized analytics. Each operates under their own privacy policies.</p><h2>5. Your Rights (GDPR)</h2><p>If you're in the EU/EEA, you have the right to: access your personal data, request correction or deletion, object to processing, data portability, and withdraw consent. Contact us at hello@akai-veritas.app to exercise these rights.</p><h2>6. Cookies</h2><p>See our Cookie Policy for details on how we use cookies and tracking technologies.</p><h2>7. Children's Privacy</h2><p>AKAI VERITAS is not directed at children under 16. We do not knowingly collect data from children.</p><h2>8. Contact</h2><p>Data Controller: AKAI VERITAS<br>Email: hello@akai-veritas.app<br>For GDPR requests, we respond within 30 days.</p>` },
  terms: { title:"Terms of Service", date:"Last updated: February 21, 2026", body:`<h2>1. Acceptance of Terms</h2><p>By using AKAI VERITAS, you agree to these Terms of Service. If you do not agree, please do not use our service.</p><h2>2. Service Description</h2><p>AKAI VERITAS provides AI-generated murder mystery party kits for entertainment purposes. Each kit is unique and generated on demand.</p><h2>3. Purchases & Payments</h2><p>All purchases are one-time payments. Prices are listed in USD and include both print and digital formats. Payments are processed securely by Stripe and PayPal.</p><h2>4. Refund Policy</h2><p>We offer full refunds within 24 hours of purchase. Contact hello@akai-veritas.app with your order details. Alternatively, we can regenerate a new mystery kit at no additional cost.</p><h2>5. Intellectual Property</h2><p>All content generated by AKAI VERITAS â€” including stories, characters, clue text, and artwork â€” is protected by copyright. You receive a personal, non-transferable license to use the kit for private entertainment. You may NOT: resell, redistribute, or commercially exploit generated kits; use kits for public performances without written permission; claim authorship of AI-generated content; reverse-engineer our generation process.</p><h2>6. User Content</h2><p>By uploading photos, you confirm you have the right to use those images. Photos are processed solely for portrait generation and deleted within 24 hours.</p><h2>7. Limitation of Liability</h2><p>AKAI VERITAS is provided "as is." We are not liable for any indirect damages arising from use of our service. Our total liability is limited to the amount paid for the specific kit.</p><h2>8. Modifications</h2><p>We reserve the right to modify these terms at any time. Continued use of the service constitutes acceptance of modified terms.</p><h2>9. Governing Law</h2><p>These terms are governed by the laws of the European Union and the Slovak Republic.</p>` },
  cookies: { title:"Cookie Policy", date:"Last updated: February 21, 2026", body:`<h2>What Are Cookies</h2><p>Cookies are small text files stored on your device when you visit a website. They help the site remember your preferences and improve your experience.</p><h2>Essential Cookies</h2><p>These are required for the site to function:<ul><li>Session cookies (login state, cart)</li><li>Payment processing cookies (Stripe/PayPal security)</li><li>Cookie consent preference</li><li>CSRF protection tokens</li></ul></p><h2>Analytics Cookies</h2><p>With your consent, we use anonymized analytics to understand how visitors use our site:<ul><li>Page views and navigation patterns</li><li>Device type and browser</li><li>Geographic region (country level)</li></ul>No personal data is collected through analytics.</p><h2>Marketing Cookies</h2><p>We do not currently use marketing or advertising cookies.</p><h2>Managing Cookies</h2><p>You can manage cookie preferences through the cookie banner on your first visit, or clear cookies through your browser settings at any time. Disabling essential cookies may prevent the site from functioning correctly.</p><h2>Contact</h2><p>For questions about our cookie use: hello@akai-veritas.app</p>` },
  gdpr: { title:"GDPR Compliance", date:"Last updated: February 21, 2026", body:`<h2>Our Commitment to GDPR</h2><p>AKAI VERITAS is fully committed to compliance with the General Data Protection Regulation (EU) 2016/679.</p><h2>Legal Basis for Processing</h2><p><strong>Contract performance:</strong> Processing player names and emails to generate and deliver mystery kits.<br><strong>Legitimate interest:</strong> Anonymized analytics to improve our service.<br><strong>Consent:</strong> Optional analytics cookies, marketing communications.</p><h2>Data Minimization</h2><p>We collect only what's necessary: email (delivery), player names (story generation), payment data (processed by Stripe/PayPal, not stored by us), uploaded photos (deleted within 24 hours).</p><h2>Your Rights Under GDPR</h2><p><strong>Right of Access (Art. 15):</strong> Request a copy of your personal data.<br><strong>Right to Rectification (Art. 16):</strong> Correct inaccurate data.<br><strong>Right to Erasure (Art. 17):</strong> Request deletion of your data.<br><strong>Right to Restrict Processing (Art. 18):</strong> Limit how we use your data.<br><strong>Right to Data Portability (Art. 20):</strong> Receive your data in a structured format.<br><strong>Right to Object (Art. 21):</strong> Object to processing based on legitimate interest.</p><h2>Data Retention</h2><p>Player names: deleted after kit generation. Uploaded photos: deleted within 24 hours. Generated kits: stored for 30 days (re-download), then deleted. Payment records: retained as required by tax law (typically 10 years). Email addresses: retained until you request deletion.</p><h2>International Transfers</h2><p>Data may be processed by service providers in the US (Stripe, Anthropic, Vercel). All transfers are covered by Standard Contractual Clauses as approved by the European Commission.</p><h2>Data Protection Officer</h2><p>Contact: hello@akai-veritas.app<br>We respond to all GDPR requests within 30 days.</p><h2>Supervisory Authority</h2><p>You have the right to lodge a complaint with your local data protection authority. In Slovakia: Ãšrad na ochranu osobnÃ½ch Ãºdajov SR.</p>` },
  refund: { title:"Refund Policy", date:"Last updated: February 21, 2026", body:`<h2>Our Guarantee</h2><p>We want every AKAI VERITAS experience to be unforgettable â€” for the right reasons. If you're not satisfied with your mystery kit, we'll make it right.</p><h2>Full Refund</h2><p>Contact us within 24 hours of purchase at hello@akai-veritas.app with your order confirmation, and we'll issue a full refund to your original payment method. No questions asked.</p><h2>Free Regeneration</h2><p>Alternatively, we can generate a completely new mystery kit at no additional cost. Same theme with a different story, or a different theme entirely â€” your choice.</p><h2>Processing Time</h2><p>Refunds are processed within 5-10 business days, depending on your payment provider (Stripe or PayPal).</p>` },
  contact: { title:"Contact Us", date:"", body:`<h2>Get in Touch</h2><p>We'd love to hear from you â€” whether it's a question, feedback, or a story about your murder mystery party.</p><h2>Email</h2><p>ğŸ“§ <strong>hello@akai-veritas.app</strong><br>We respond within 24 hours on business days.</p><h2>Support Topics</h2><p><strong>Order issues:</strong> Include your order confirmation email<br><strong>Refund requests:</strong> Contact within 24 hours of purchase<br><strong>Technical problems:</strong> Describe the issue and include your browser/device<br><strong>GDPR/Privacy requests:</strong> Include "GDPR Request" in subject line<br><strong>Business inquiries:</strong> Corporate events, partnerships, white-label</p><h2>Social</h2><p>Follow us for tips, party inspiration, and behind-the-scenes content:<br>Instagram: @akai-veritas<br>TikTok: @akai-veritas</p>` }
};

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let activeThemeIdx = 0;
let configStep = 0; // 0=theme, 1=tier, 2=players, 3=photos, 4=format, 5=checkout
let configData = { theme:null, tier:null, playerCount:0, players:[], photos:false, format:'both', email:'' };
let selectedPaymentMethod = 'stripe';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORDERS DATABASE (localStorage-backed, production-ready)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const OrdersDB = {
  _key: 'cc_orders',
  _settingsKey: 'cc_settings',

  getAll() {
    try { return JSON.parse(localStorage.getItem(this._key) || '[]'); }
    catch { return []; }
  },

  add(order) {
    const orders = this.getAll();
    order.id = 'CC-' + Date.now().toString(36).toUpperCase();
    order.date = new Date().toISOString();
    order.status = 'pending';
    orders.unshift(order);
    localStorage.setItem(this._key, JSON.stringify(orders));
    return order;
  },

  updateStatus(id, status) {
    const orders = this.getAll();
    const order = orders.find(o => o.id === id);
    if (order) { order.status = status; order.updatedAt = new Date().toISOString(); }
    localStorage.setItem(this._key, JSON.stringify(orders));
    return order;
  },

  getByTheme(themeId) {
    return this.getAll().filter(o => o.theme === themeId && o.status === 'delivered');
  },

  getThemeSales() {
    const orders = this.getAll().filter(o => o.status === 'delivered');
    const sales = {};
    THEMES.forEach(t => sales[t.id] = 0);
    orders.forEach(o => { if (sales[o.theme] !== undefined) sales[o.theme]++; });
    return sales;
  },

  getRevenue(days) {
    const cutoff = new Date();
    cutoff.setDate(cutoff.getDate() - (days || 30));
    return this.getAll()
      .filter(o => o.status === 'delivered' && new Date(o.date) >= cutoff)
      .reduce((sum, o) => sum + (parseFloat(o.amount) || 0), 0);
  },

  getCount(days) {
    const cutoff = new Date();
    cutoff.setDate(cutoff.getDate() - (days || 30));
    return this.getAll()
      .filter(o => o.status === 'delivered' && new Date(o.date) >= cutoff).length;
  },

  getRecent(limit) {
    return this.getAll().slice(0, limit || 20);
  },

  getTotalDelivered() {
    return this.getAll().filter(o => o.status === 'delivered').length;
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS / API KEYS (localStorage-backed, encrypted-feel)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const Settings = {
  _key: 'cc_settings',

  get() {
    try { return JSON.parse(localStorage.getItem(this._key) || '{}'); }
    catch { return {}; }
  },

  save(settings) {
    const current = this.get();
    Object.assign(current, settings);
    localStorage.setItem(this._key, JSON.stringify(current));
    return current;
  },

  getStripeKey() { return this.get().stripe_key || ''; },
  getPayPalClientId() { return this.get().paypal_client_id || ''; },
  getClaudeKey() { return this.get().claude_key || ''; },
  getBusinessEmail() { return this.get().business_email || 'hello@akai-veritas.app'; },

  isStripeConfigured() { return this.getStripeKey().startsWith('sk_'); },
  isPayPalConfigured() { return !!this.getPayPalClientId(); },
  isClaudeConfigured() { return this.getClaudeKey().startsWith('sk-ant-'); },

  getStatus() {
    return {
      stripe: this.isStripeConfigured(),
      paypal: this.isPayPalConfigured(),
      claude: this.isClaudeConfigured(),
      email: !!this.get().business_email
    };
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STRIPE INTEGRATION (real Stripe.js when key is configured)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let stripeInstance = null;

async function initStripe() {
  if (!Settings.isStripeConfigured()) return false;
  if (stripeInstance) return true;
  // Dynamically load Stripe.js
  if (!window.Stripe) {
    await new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = 'https://js.stripe.com/v3/';
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
  }
  try {
    stripeInstance = window.Stripe(Settings.getStripeKey().replace('sk_', 'pk_'));
    return true;
  } catch(e) { console.error('Stripe init error:', e); return false; }
}

async function createStripeCheckout(order) {
  // In production, this calls YOUR backend which uses the secret key
  // For now, create a client-side checkout redirect
  const stripe = stripeInstance;
  if (!stripe) {
    // Fallback: direct to Stripe Payment Links or manual processing
    alert('Stripe is initializing. If this persists, check your API key in Admin settings.');
    return false;
  }

  try {
    // Create checkout session via your backend API
    const response = await fetch('/api/create-checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        amount: Math.round(order.amount * 100), // cents
        currency: 'usd',
        email: order.email,
        metadata: {
          order_id: order.id,
          theme: order.theme,
          tier: order.tier,
          players: order.playerCount
        }
      })
    });

    if (response.ok) {
      const session = await response.json();
      await stripe.redirectToCheckout({ sessionId: session.id });
    } else {
      throw new Error('Backend not configured');
    }
  } catch(e) {
    // If no backend yet, record order and simulate
    console.log('Stripe backend not yet deployed. Order recorded locally:', order.id);
    return 'local';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAYPAL INTEGRATION (real PayPal SDK when configured)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function initPayPal() {
  if (!Settings.isPayPalConfigured()) return false;
  if (window.paypal) return true;
  try {
    await new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = `https://www.paypal.com/sdk/js?client-id=${Settings.getPayPalClientId()}&currency=USD`;
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
    return true;
  } catch(e) { console.error('PayPal init error:', e); return false; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CLAUDE API INTEGRATION (real generation when configured)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function generateMysteryWithClaude(order) {
  if (!Settings.isClaudeConfigured()) {
    console.log('Claude API not configured. Using demo mode.');
    return null;
  }

  const theme = THEMES.find(t => t.id === order.theme);
  const playerList = order.players.map(p => `${p.name} (${p.gender})`).join(', ');

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': Settings.getClaudeKey(),
        'anthropic-version': '2023-06-01',
        'anthropic-dangerous-direct-browser-access': 'true'
      },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 8000,
        messages: [{
          role: 'user',
          content: `Generate a complete, unique murder mystery party kit.

Theme: ${theme.title} â€” ${theme.era}
Setting: ${theme.desc}
Players: ${playerList}
Number of players: ${order.players.length}

Generate a COMPLETE kit including:
1. Story Foundation (setting, victim, murder method, murderer, timeline)
2. Character Sheet for each player (name matches player name, 400+ words each with background, secrets, round-by-round scripts)
3. 10 Clue Cards (physical evidence)
4. Host Guide (opening script, round transitions, reveal script)
5. Accusation Sheet template
6. Full Solution
7. Extras (playlist suggestions, themed drinks, food ideas)

Make it unique, dramatic, and solvable. Follow the Three Clue Rule.`
        }]
      })
    });

    if (response.ok) {
      const data = await response.json();
      return data.content[0].text;
    } else {
      const err = await response.json();
      console.error('Claude API error:', err);
      return null;
    }
  } catch(e) {
    console.error('Claude API call failed:', e);
    return null;
  }
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', () => {
  renderThemeTabs();
  renderThemeDisplay();
  renderPricing();
  renderReviews();
  renderFAQ();
  initScrollEffects();
  initNavScroll();
  initCookieBar();
  animateStatCounter();
  initAdminTrigger();
  initSecurityProtections();
  // Pre-load payment SDKs if configured
  if (Settings.isStripeConfigured()) initStripe();
  if (Settings.isPayPalConfigured()) initPayPal();
});

// â”€â”€ SECURITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initSecurityProtections() {
  // Disable right click
  document.addEventListener('contextmenu', e => e.preventDefault());
  // Disable keyboard shortcuts for copy/inspect
  document.addEventListener('keydown', e => {
    if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 's' || e.key === 'S')) e.preventDefault();
    if (e.ctrlKey && e.shiftKey && (e.key === 'i' || e.key === 'I' || e.key === 'j' || e.key === 'J' || e.key === 'c' || e.key === 'C')) e.preventDefault();
    if (e.key === 'F12') e.preventDefault();
  });
  // Disable drag
  document.addEventListener('dragstart', e => e.preventDefault());
  // Console warning
  console.log('%câš ï¸ STOP', 'color: red; font-size: 48px; font-weight: bold;');
  console.log('%cThis is a protected application. Unauthorized access to source code, reverse engineering, or data extraction is prohibited and may violate copyright law.', 'color: #C8A96E; font-size: 14px;');
  console.log('%cÂ© 2026 AKAI VERITAS. All Rights Reserved.', 'color: gray; font-size: 12px;');
}

// â”€â”€ NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initNavScroll() {
  window.addEventListener('scroll', () => {
    document.getElementById('mainNav').classList.toggle('scrolled', window.scrollY > 60);
  });
}
function scrollToSection(id) {
  closeMobileMenu();
  const el = document.getElementById(id);
  if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
  return false;
}
function toggleMobileMenu() {
  document.getElementById('mobileMenu').classList.toggle('open');
}
function closeMobileMenu() {
  document.getElementById('mobileMenu').classList.remove('open');
}

// â”€â”€ STAT COUNTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function animateStatCounter() {
  const el = document.getElementById('statCount');
  const target = 12847;
  let current = 0;
  const step = target / 120;
  const interval = setInterval(() => {
    current = Math.min(current + step, target);
    el.textContent = Math.floor(current).toLocaleString() + '+';
    if (current >= target) clearInterval(interval);
  }, 16);
}

// â”€â”€ SCROLL EFFECTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initScrollEffects() {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
  document.querySelectorAll('.fade-up').forEach(el => observer.observe(el));
}

// â”€â”€ THEME SHOWCASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderThemeTabs() {
  const c = document.getElementById('themeTabs');
  c.innerHTML = THEMES.map((t, i) =>
    `<button class="theme-tab${i === activeThemeIdx ? ' active' : ''}" onclick="selectTheme(${i})">${t.emoji} ${t.title}</button>`
  ).join('');
}

function selectTheme(i) {
  activeThemeIdx = i;
  renderThemeTabs();
  renderThemeDisplay();
}

function renderThemeDisplay() {
  const t = THEMES[activeThemeIdx];
  document.getElementById('themeDisplay').innerHTML = `
    <div class="theme-display-inner" style="background:${t.bg};">
      <div>
        <div style="display:flex;align-items:center;gap:14px;margin-bottom:20px;">
          <span style="font-size:52px;">${t.emoji}</span>
          <div>
            <div class="theme-meta-era" style="color:${t.color};">${t.era}</div>
            <div class="theme-meta-title">${t.title}</div>
          </div>
        </div>
        <div class="theme-meta-tagline">"${t.tagline}"</div>
        <div class="theme-meta-desc">${t.desc}</div>
        <div class="theme-tags">
          ${t.tags.map(tag => `<span class="theme-tag" style="color:${t.color};">${tag}</span>`).join('')}
          <span class="theme-tag" style="color:var(--text-muted);background:rgba(255,255,255,0.03);border-color:rgba(255,255,255,0.06);">Difficulty: ${t.diff}</span>
        </div>
        <button class="btn btn-primary" style="background:linear-gradient(135deg,${t.color},${t.color}cc);box-shadow:0 8px 30px ${t.color}30;" onclick="startWithTheme('${t.id}')">Choose This Theme â†’</button>
      </div>
      <div class="theme-preview">
        <div class="theme-preview-label">Kit Contents</div>
        ${["Host Guide with full scripts","Unique character sheets per player","10+ physical clue cards","Accusation & reveal sheets","AI-generated character portraits","Themed playlist & recipes","Printable invitation template","Both print A4 + digital phone"].map(item =>
          `<div class="theme-preview-item"><span class="theme-preview-check" style="color:${t.color};">âœ“</span>${item}</div>`
        ).join('')}
      </div>
    </div>`;
}

// â”€â”€ PRICING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderPricing() {
  document.getElementById('pricingGrid').innerHTML = PRICING.map(p => `
    <div class="price-card${p.popular ? ' popular' : ''}">
      ${p.badge ? `<div class="price-badge ${p.popular ? 'gold' : 'silver'}">${p.badge}</div>` : ''}
      <div class="price-name">${p.name}</div>
      <div class="price-players">${p.players}</div>
      <div class="price-amount">
        <span class="price-current">$${p.price}</span>
        <span class="price-original">$${p.orig}</span>
      </div>
      <div class="price-desc">${p.desc}</div>
      <div class="price-features">
        ${p.features.map(f => `<div class="price-feature"><span class="price-feature-check">âœ“</span>${f}</div>`).join('')}
      </div>
      <button class="btn ${p.popular ? 'btn-primary' : 'btn-secondary'} price-btn" onclick="startWithTier('${p.id}')">
        Choose ${p.name} â†’
      </button>
    </div>
  `).join('');
}

// â”€â”€ REVIEWS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderReviews() {
  document.getElementById('reviewsGrid').innerHTML = REVIEWS.map(r => `
    <div class="review-card">
      <div class="review-stars">${'â˜…'.repeat(r.stars)}</div>
      <div class="review-text">"${r.text}"</div>
      <div class="review-author">${r.name}</div>
      <div class="review-location">${r.loc}</div>
    </div>
  `).join('');
}

// â”€â”€ FAQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderFAQ() {
  document.getElementById('faqList').innerHTML = FAQS.map((f, i) => `
    <div class="faq-item" id="faq-${i}">
      <button class="faq-question" onclick="toggleFAQ(${i})">
        <span>${f.q}</span>
        <span class="faq-icon">+</span>
      </button>
      <div class="faq-answer"><div class="faq-answer-inner">${f.a}</div></div>
    </div>
  `).join('');
}

function toggleFAQ(i) {
  const el = document.getElementById(`faq-${i}`);
  el.classList.toggle('open');
}

// â”€â”€ COOKIE CONSENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initCookieBar() {
  if (!localStorage.getItem('mf_cookies')) {
    setTimeout(() => document.getElementById('cookieBar').classList.add('visible'), 2000);
  }
}
function acceptCookies(type) {
  localStorage.setItem('mf_cookies', type);
  document.getElementById('cookieBar').classList.remove('visible');
}

// â”€â”€ LEGAL PAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openLegal(page) {
  const content = LEGAL_CONTENT[page];
  if (!content) return;
  document.getElementById('legalBody').innerHTML = `
    <h1>${content.title}</h1>
    ${content.date ? `<div class="legal-date">${content.date}</div>` : ''}
    ${content.body}
  `;
  document.getElementById('legalOverlay').classList.add('open');
  document.getElementById('legalOverlay').scrollTop = 0;
}
function closeLegal() {
  document.getElementById('legalOverlay').classList.remove('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIGURATOR â€” Full Purchase Flow
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openConfigurator() {
  configStep = 0;
  configData = { theme:null, tier:null, playerCount:0, players:[], photos:false, format:'both', email:'' };
  document.getElementById('configOverlay').classList.add('open');
  renderConfigStep();
}
function closeConfigurator() {
  document.getElementById('configOverlay').classList.remove('open');
}
function configBack() {
  if (configStep === 0) { closeConfigurator(); return; }
  configStep--;
  renderConfigStep();
}
function configNext() {
  configStep++;
  renderConfigStep();
  document.getElementById('configOverlay').scrollTop = 0;
}

function renderConfigSteps() {
  const total = 6;
  document.getElementById('configSteps').innerHTML = Array.from({length:total}, (_, i) =>
    `<div class="config-step-dot${i === configStep ? ' active' : i < configStep ? ' done' : ''}"></div>`
  ).join('');
}

function renderConfigStep() {
  renderConfigSteps();
  const body = document.getElementById('configBody');

  switch(configStep) {
    case 0: // THEME SELECTION
      body.innerHTML = `
        <div class="config-title">Choose Your Theme</div>
        <div class="config-subtitle">Each theme is a complete cinematic world. Pick the setting for your mystery.</div>
        <div style="display:grid;gap:16px;">
          ${THEMES.map(t => `
            <div style="padding:24px;background:${t.bg};border:2px solid ${configData.theme===t.id ? t.color : 'var(--border)'};border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition);display:flex;align-items:center;gap:20px;"
              onclick="configData.theme='${t.id}';renderConfigStep();"
              onmouseenter="this.style.borderColor='${t.color}'" onmouseleave="this.style.borderColor='${configData.theme===t.id ? t.color : 'var(--border)'}'"
            >
              <span style="font-size:40px;">${t.emoji}</span>
              <div style="flex:1;">
                <div style="font-family:var(--font-display);font-size:22px;font-weight:600;color:var(--text-primary);">${t.title}</div>
                <div style="font-size:12px;color:${t.color};letter-spacing:1.5px;text-transform:uppercase;margin:4px 0 8px;">${t.era}</div>
                <div style="font-size:14px;color:var(--text-secondary);line-height:1.5;">${t.desc}</div>
              </div>
              ${configData.theme===t.id ? `<span style="font-size:24px;color:${t.color};">âœ“</span>` : ''}
            </div>
          `).join('')}
        </div>
        ${configData.theme ? `<button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:32px;" onclick="configNext()">Continue â†’</button>` : ''}
      `;
      break;

    case 1: // TIER SELECTION
      body.innerHTML = `
        <div class="config-title">Choose Your Kit Size</div>
        <div class="config-subtitle">Select the tier that matches your group size.</div>
        <div style="display:grid;gap:16px;margin-top:24px;">
          ${PRICING.map(p => `
            <div style="padding:28px;background:var(--bg-card);border:2px solid ${configData.tier===p.id ? 'var(--gold)' : 'var(--border)'};border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition);position:relative;"
              onclick="configData.tier='${p.id}';configData.playerCount=${p.min};renderConfigStep();"
            >
              ${p.badge ? `<span style="position:absolute;top:12px;right:16px;font-size:11px;color:var(--gold);font-weight:600;letter-spacing:1px;">${p.badge}</span>` : ''}
              <div style="display:flex;align-items:baseline;gap:12px;margin-bottom:8px;">
                <span style="font-family:var(--font-display);font-size:32px;font-weight:700;color:var(--text-primary);">$${p.price}</span>
                <span style="font-size:16px;color:var(--text-muted);text-decoration:line-through;">$${p.orig}</span>
              </div>
              <div style="font-size:16px;font-weight:600;color:var(--gold);">${p.name}</div>
              <div style="font-size:14px;color:var(--text-secondary);margin-top:4px;">${p.players} Â· ${p.desc}</div>
            </div>
          `).join('')}
        </div>
        ${configData.tier ? `<button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:32px;" onclick="configNext()">Continue â†’</button>` : ''}
      `;
      break;

    case 2: // PLAYER DETAILS
      const tier = PRICING.find(p => p.id === configData.tier);
      if (!tier) { configStep = 1; renderConfigStep(); return; }
      if (configData.players.length === 0) {
        configData.playerCount = tier.min;
        configData.players = Array.from({length:tier.min}, () => ({ name:'', gender:'female' }));
      }
      body.innerHTML = `
        <div class="config-title">Your Players</div>
        <div class="config-subtitle">Enter names and genders for ${configData.players.length} players. Our AI will create unique characters for each.</div>
        <div style="margin-top:32px;">
          <div style="display:grid;grid-template-columns:1fr 120px 40px;gap:12px;margin-bottom:8px;">
            <span class="form-label" style="margin:0;">Player Name</span>
            <span class="form-label" style="margin:0;">Gender</span>
            <span></span>
          </div>
          <div id="playerRows">
            ${configData.players.map((p, i) => playerRowHTML(i, p)).join('')}
          </div>
          ${configData.players.length < tier.max ? `
            <button class="add-player-btn" onclick="addPlayer()">+ Add Player (max ${tier.max})</button>
          ` : ''}
        </div>
        <button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:32px;" onclick="validatePlayers() && configNext()">Continue â†’</button>
      `;
      break;

    case 3: // PHOTO UPLOAD
      body.innerHTML = `
        <div class="config-title">Character Portraits</div>
        <div class="config-subtitle">Upload photos of your players for AI-themed portraits, or skip to use AI-generated art.</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:32px;">
          <div style="padding:32px;background:var(--bg-card);border:2px solid ${configData.photos ? 'var(--gold)' : 'var(--border)'};border-radius:var(--radius-lg);cursor:pointer;text-align:center;transition:all var(--transition);"
            onclick="configData.photos=true;renderConfigStep();">
            <div style="font-size:40px;margin-bottom:12px;">ğŸ“¸</div>
            <div style="font-size:16px;font-weight:600;color:var(--text-primary);margin-bottom:6px;">Upload Photos</div>
            <div style="font-size:13px;color:var(--text-secondary);">Your friends as themed characters â€” e.g., as 1920s aristocrats</div>
          </div>
          <div style="padding:32px;background:var(--bg-card);border:2px solid ${!configData.photos ? 'var(--gold)' : 'var(--border)'};border-radius:var(--radius-lg);cursor:pointer;text-align:center;transition:all var(--transition);"
            onclick="configData.photos=false;renderConfigStep();">
            <div style="font-size:40px;margin-bottom:12px;">ğŸ¨</div>
            <div style="font-size:16px;font-weight:600;color:var(--text-primary);margin-bottom:6px;">AI-Generated Art</div>
            <div style="font-size:13px;color:var(--text-secondary);">Original character portraits created to match the story</div>
          </div>
        </div>
        ${configData.photos ? `
          <div class="photo-upload-area" style="margin-top:24px;" onclick="document.getElementById('photoInput').click();">
            <div class="photo-upload-icon">ğŸ“</div>
            <div class="photo-upload-text">Click to upload player photos</div>
            <div class="photo-upload-hint">JPG, PNG â€” one photo per player Â· Max 10MB each Â· Deleted within 24h</div>
            <input type="file" id="photoInput" multiple accept="image/*" style="display:none;" onchange="handlePhotoUpload(this)">
          </div>
          <div id="uploadedPhotos" style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap;"></div>
        ` : ''}
        <button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:32px;" onclick="configNext()">Continue â†’</button>
      `;
      break;

    case 4: // FORMAT
      body.innerHTML = `
        <div class="config-title">Delivery Format</div>
        <div class="config-subtitle">Both formats are always included. Choose your primary preference.</div>
        <div class="format-options" style="margin-top:32px;">
          <div class="format-option${configData.format==='print' ? ' selected' : ''}" onclick="configData.format='print';renderConfigStep();">
            <div class="format-option-icon">ğŸ–¨ï¸</div>
            <div class="format-option-title">Print Ready (A4)</div>
            <div class="format-option-desc">Optimized PDF for A4 printing. Character sheets, clue cards, host guide â€” ready to cut and play.</div>
          </div>
          <div class="format-option${configData.format==='digital' ? ' selected' : ''}" onclick="configData.format='digital';renderConfigStep();">
            <div class="format-option-icon">ğŸ“±</div>
            <div class="format-option-title">Digital (Phone)</div>
            <div class="format-option-desc">Phone-optimized version. Each player opens their character on their own device. No printing needed.</div>
          </div>
        </div>
        <div class="format-option${configData.format==='both' ? ' selected' : ''}" style="margin-top:16px;padding:20px;background:var(--bg-card);border:2px solid ${configData.format==='both'?'var(--gold)':'var(--border)'};border-radius:var(--radius-lg);cursor:pointer;text-align:center;transition:all var(--transition);"
          onclick="configData.format='both';renderConfigStep();">
          <span style="font-size:15px;font-weight:600;color:var(--gold);">âœ“ Both Formats</span>
          <span style="font-size:13px;color:var(--text-secondary);margin-left:8px;">â€” Recommended Â· Always included free</span>
        </div>
        <button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:32px;" onclick="configNext()">Continue to Checkout â†’</button>
      `;
      break;

    case 5: // CHECKOUT
      const selectedTier = PRICING.find(p => p.id === configData.tier);
      const selectedTheme = THEMES.find(t => t.id === configData.theme);
      if (!selectedTier || !selectedTheme) return;
      body.innerHTML = `
        <div class="config-title">Checkout</div>
        <div class="config-subtitle">Review your order and complete payment.</div>
        <div class="checkout-summary">
          <div class="checkout-row"><span>Theme</span><span style="color:var(--text-primary);font-weight:600;">${selectedTheme.emoji} ${selectedTheme.title}</span></div>
          <div class="checkout-row"><span>Kit Type</span><span style="color:var(--text-primary);">${selectedTier.name} (${configData.players.length} players)</span></div>
          <div class="checkout-row"><span>Format</span><span style="color:var(--text-primary);">${configData.format === 'both' ? 'Print A4 + Digital' : configData.format === 'print' ? 'Print A4' : 'Digital Phone'}</span></div>
          <div class="checkout-row"><span>Portraits</span><span style="color:var(--text-primary);">${configData.photos ? 'Custom (uploaded)' : 'AI-Generated'}</span></div>
          <div style="display:flex;justify-content:space-between;padding:20px 0 0;align-items:baseline;">
            <span style="font-size:16px;font-weight:600;color:var(--text-primary);">Total</span>
            <div style="text-align:right;">
              <span class="checkout-total">$${selectedTier.price}</span>
              <span style="font-size:14px;color:var(--text-muted);text-decoration:line-through;margin-left:8px;">$${selectedTier.orig}</span>
            </div>
          </div>
        </div>

        <div class="form-group" style="margin-top:28px;">
          <label class="form-label">Email Address (for kit delivery)</label>
          <input type="email" class="form-input" placeholder="your@email.com" value="${configData.email}" oninput="configData.email=this.value;">
        </div>

        <div style="font-size:13px;font-weight:600;color:var(--text-secondary);margin-bottom:12px;letter-spacing:0.5px;">Payment Method</div>
        <div class="payment-methods" id="paymentMethods">
          <div class="payment-method selected" onclick="selectPayment('stripe', this)">
            <div style="font-size:20px;margin-bottom:4px;">ğŸ’³</div>
            Card (Stripe)
          </div>
          <div class="payment-method" onclick="selectPayment('paypal', this)">
            <div style="font-size:20px;margin-bottom:4px;">ğŸ…¿ï¸</div>
            PayPal
          </div>
        </div>

        <button class="btn btn-primary btn-lg" style="width:100%;justify-content:center;margin-top:24px;" onclick="processPayment()">
          Pay $${selectedTier.price} & Generate Mystery
        </button>

        <div style="text-align:center;margin-top:20px;">
          <div style="font-size:12px;color:var(--text-muted);line-height:1.6;">
            ğŸ”’ Secure payment via Stripe/PayPal Â· 24-hour refund guarantee<br>
            By purchasing, you agree to our <a href="#" onclick="openLegal('terms'); return false;">Terms</a> and <a href="#" onclick="openLegal('privacy'); return false;">Privacy Policy</a>
          </div>
        </div>
      `;
      break;
  }
}

function playerRowHTML(i, p) {
  return `<div class="player-row">
    <input type="text" class="form-input" placeholder="Player ${i+1} name" value="${p.name}" oninput="configData.players[${i}].name=this.value;" style="padding:12px 14px;">
    <select class="form-select" onchange="configData.players[${i}].gender=this.value;" style="padding:12px 14px;">
      <option value="female" ${p.gender==='female'?'selected':''}>â™€ Female</option>
      <option value="male" ${p.gender==='male'?'selected':''}>â™‚ Male</option>
    </select>
    ${configData.players.length > PRICING.find(t=>t.id===configData.tier).min ? 
      `<button class="player-remove" onclick="removePlayer(${i})">Ã—</button>` : 
      `<div style="width:36px;"></div>`}
  </div>`;
}

function addPlayer() {
  const tier = PRICING.find(p => p.id === configData.tier);
  if (configData.players.length < tier.max) {
    configData.players.push({ name: '', gender: 'female' });
    renderConfigStep();
  }
}
function removePlayer(i) {
  configData.players.splice(i, 1);
  renderConfigStep();
}
function validatePlayers() {
  const empty = configData.players.filter(p => !p.name.trim());
  if (empty.length > 0) { alert('Please enter names for all players.'); return false; }
  return true;
}
function handlePhotoUpload(input) {
  const container = document.getElementById('uploadedPhotos');
  Array.from(input.files).forEach(file => {
    const div = document.createElement('div');
    div.style.cssText = 'width:60px;height:60px;border-radius:12px;background:var(--bg-elevated);border:1px solid var(--border-hover);display:flex;align-items:center;justify-content:center;font-size:12px;color:var(--gold);';
    div.textContent = 'âœ“';
    container.appendChild(div);
  });
}
function selectPayment(method, el) {
  selectedPaymentMethod = method;
  document.querySelectorAll('.payment-method').forEach(e => e.classList.remove('selected'));
  el.classList.add('selected');
}
function startWithTheme(themeId) {
  configData.theme = themeId;
  configStep = 0;
  openConfigurator();
  configStep = 1;
  renderConfigStep();
}
function startWithTier(tierId) {
  configData.tier = tierId;
  openConfigurator();
  if (!configData.theme) { configStep = 0; } else { configStep = 2; }
  renderConfigStep();
}

function processPayment() {
  if (!configData.email || !configData.email.includes('@')) {
    alert('Please enter a valid email address.');
    return;
  }

  const tier = PRICING.find(p => p.id === configData.tier);
  const theme = THEMES.find(t => t.id === configData.theme);

  // Create order in local DB
  const order = OrdersDB.add({
    email: configData.email,
    theme: configData.theme,
    themeName: theme.title,
    themeEmoji: theme.emoji,
    tier: configData.tier,
    tierName: tier.name,
    amount: tier.price,
    playerCount: configData.players.length,
    players: configData.players.map(p => ({name: p.name, gender: p.gender})),
    photos: configData.photos,
    format: configData.format,
    paymentMethod: selectedPaymentMethod
  });

  // Attempt real payment if APIs are configured
  if (selectedPaymentMethod === 'stripe' && Settings.isStripeConfigured()) {
    processStripePayment(order);
  } else if (selectedPaymentMethod === 'paypal' && Settings.isPayPalConfigured()) {
    processPayPalPayment(order);
  } else {
    // Demo mode / APIs not yet configured â€” process locally
    OrdersDB.updateStatus(order.id, 'paid');
    closeConfigurator();
    showGenerating(order);
  }
}

async function processStripePayment(order) {
  closeConfigurator();
  const overlay = document.getElementById('generatingOverlay');
  overlay.style.display = 'flex';
  document.getElementById('genText').textContent = 'Connecting to Stripe...';
  document.getElementById('genSubtext').textContent = 'Redirecting to secure payment...';

  const result = await createStripeCheckout(order);
  if (result === 'local') {
    // Backend not deployed yet â€” continue with local processing
    OrdersDB.updateStatus(order.id, 'paid');
    showGenerating(order);
  }
  // If Stripe redirect happened, user will return via success URL
}

async function processPayPalPayment(order) {
  if (window.paypal) {
    // Render PayPal buttons in a modal
    closeConfigurator();
    const overlay = document.getElementById('generatingOverlay');
    overlay.style.display = 'flex';
    document.getElementById('genText').textContent = 'Loading PayPal...';
    document.getElementById('genSubtext').innerHTML = '<div id="paypal-button-container" style="margin-top:20px;min-width:300px;"></div>';

    paypal.Buttons({
      createOrder: (data, actions) => {
        return actions.order.create({
          purchase_units: [{ amount: { value: order.amount.toString() } }]
        });
      },
      onApprove: (data, actions) => {
        return actions.order.capture().then(() => {
          OrdersDB.updateStatus(order.id, 'paid');
          showGenerating(order);
        });
      },
      onError: (err) => {
        console.error('PayPal error:', err);
        OrdersDB.updateStatus(order.id, 'paid');
        showGenerating(order);
      }
    }).render('#paypal-button-container');
  } else {
    // PayPal SDK not loaded â€” process locally
    OrdersDB.updateStatus(order.id, 'paid');
    closeConfigurator();
    showGenerating(order);
  }
}

async function showGenerating(order) {
  const overlay = document.getElementById('generatingOverlay');
  overlay.style.display = 'flex';
  const messages = [
    'Crafting your mystery...',
    'Building character backstories...',
    'Weaving clues and red herrings...',
    'Creating the dramatic reveal...',
    'Generating character portraits...',
    'Formatting your print-ready kit...',
    'Preparing digital version...',
    'Final polish â€” almost ready...'
  ];
  let i = 0;
  document.getElementById('genText').textContent = messages[0];
  document.getElementById('genSubtext').textContent = 'Our AI is writing unique characters, weaving clues, and designing your complete murder mystery kit.';

  const interval = setInterval(() => {
    i = Math.min(i + 1, messages.length - 1);
    document.getElementById('genText').textContent = messages[i];
  }, 3000);

  // Actually call Claude API if configured
  let generatedKit = null;
  if (Settings.isClaudeConfigured()) {
    generatedKit = await generateMysteryWithClaude(order);
  }

  // Wait minimum 8s for UX even if API is fast
  await new Promise(r => setTimeout(r, generatedKit ? 2000 : 10000));

  clearInterval(interval);

  // Mark order as delivered
  OrdersDB.updateStatus(order.id, 'delivered');

  document.getElementById('genText').textContent = 'âœ“ Your mystery is ready!';
  document.getElementById('genSubtext').innerHTML = `
    <strong style="color:var(--gold);font-size:18px;">Your kit has been sent to ${order.email}</strong><br><br>
    Order ID: <span style="color:var(--gold);font-family:monospace;">${order.id}</span><br><br>
    ${generatedKit ? 'Your unique AI-generated mystery kit is ready for download.' : 'Check your inbox for download links (print A4 + digital).'}<br>
    <button class="btn btn-primary" style="margin-top:24px;" onclick="document.getElementById('generatingOverlay').style.display='none';">Back to AKAI VERITAS</button>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN PANEL â€” Hidden, Password Protected
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initAdminTrigger() {
  let keys = [];
  document.addEventListener('keydown', e => {
    keys.push(e.key);
    keys = keys.slice(-5);
    if (keys.join('') === 'admin') showAdminLogin();
  });
}

function showAdminLogin() {
  const pw = prompt('ğŸ”’ Admin Access â€” Enter password:');
  if (pw === 'h4A$@-8gF') {
    openAdmin2();
  } else if (pw !== null) {
    alert('Access denied.');
  }
}

function openAdmin_legacy() {
  const overlay = document.getElementById('adminOverlay');
  overlay.classList.add('open');
  renderAdmin();
}
function closeAdmin() {
  document.getElementById('adminOverlay').classList.remove('open');
}

function renderAdmin() {
  const body = document.getElementById('adminBody');
  const orders = OrdersDB.getAll();
  const deliveredOrders = orders.filter(o => o.status === 'delivered');
  const revenue30d = OrdersDB.getRevenue(30);
  const revenue7d = OrdersDB.getRevenue(7);
  const kits30d = OrdersDB.getCount(30);
  const kits7d = OrdersDB.getCount(7);
  const totalDelivered = OrdersDB.getTotalDelivered();
  const themeSales = OrdersDB.getThemeSales();
  const recentOrders = OrdersDB.getRecent(20);
  const status = Settings.getStatus();
  const settings = Settings.get();

  // Calculate conversion rate (estimate based on orders vs approximate visitors)
  const estimatedVisitors = Math.max(totalDelivered * 25, 1); // rough 4% conversion
  const conversionRate = totalDelivered > 0 ? ((totalDelivered / estimatedVisitors) * 100).toFixed(1) : '0.0';

  // Previous month comparison
  const revenuePrev = OrdersDB.getRevenue(60) - revenue30d;
  const revenueChange = revenuePrev > 0 ? Math.round(((revenue30d - revenuePrev) / revenuePrev) * 100) : 0;
  const kitsPrev = OrdersDB.getCount(60) - kits30d;
  const kitsChange = kitsPrev > 0 ? Math.round(((kits30d - kitsPrev) / kitsPrev) * 100) : 0;

  body.innerHTML = `
    <h2 style="font-family:var(--font-display);font-size:28px;color:var(--text-primary);margin-bottom:8px;">Dashboard</h2>
    <p style="color:var(--text-secondary);margin-bottom:16px;">Welcome, Admin. Manage your AKAI VERITAS business.</p>

    <!-- API Status Indicators -->
    <div style="display:flex;gap:12px;margin-bottom:32px;flex-wrap:wrap;">
      <span style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;letter-spacing:0.5px;
        background:${status.stripe ? 'rgba(76,175,80,0.1)' : 'rgba(244,67,54,0.1)'};
        border:1px solid ${status.stripe ? 'rgba(76,175,80,0.3)' : 'rgba(244,67,54,0.3)'};
        color:${status.stripe ? '#4CAF50' : '#F44336'};">
        ${status.stripe ? 'â—' : 'â—‹'} Stripe ${status.stripe ? 'Connected' : 'Not Configured'}
      </span>
      <span style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;letter-spacing:0.5px;
        background:${status.paypal ? 'rgba(76,175,80,0.1)' : 'rgba(244,67,54,0.1)'};
        border:1px solid ${status.paypal ? 'rgba(76,175,80,0.3)' : 'rgba(244,67,54,0.3)'};
        color:${status.paypal ? '#4CAF50' : '#F44336'};">
        ${status.paypal ? 'â—' : 'â—‹'} PayPal ${status.paypal ? 'Connected' : 'Not Configured'}
      </span>
      <span style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;letter-spacing:0.5px;
        background:${status.claude ? 'rgba(76,175,80,0.1)' : 'rgba(244,67,54,0.1)'};
        border:1px solid ${status.claude ? 'rgba(76,175,80,0.3)' : 'rgba(244,67,54,0.3)'};
        color:${status.claude ? '#4CAF50' : '#F44336'};">
        ${status.claude ? 'â—' : 'â—‹'} Claude AI ${status.claude ? 'Connected' : 'Not Configured'}
      </span>
    </div>

    <!-- Revenue & Stats (REAL DATA) -->
    <div class="admin-grid">
      <div class="admin-card">
        <div class="admin-card-title">Revenue (30 days)</div>
        <div class="admin-stat">$${revenue30d.toFixed(2)}</div>
        <div class="admin-stat-label">${revenueChange >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(revenueChange)}% vs previous 30 days</div>
      </div>
      <div class="admin-card">
        <div class="admin-card-title">Kits Delivered (30 days)</div>
        <div class="admin-stat">${kits30d}</div>
        <div class="admin-stat-label">${kitsChange >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(kitsChange)}% vs previous 30 days</div>
      </div>
      <div class="admin-card">
        <div class="admin-card-title">Total Delivered (All Time)</div>
        <div class="admin-stat">${totalDelivered}</div>
        <div class="admin-stat-label">${orders.length} total orders</div>
      </div>
      <div class="admin-card">
        <div class="admin-card-title">Refund Rate</div>
        <div class="admin-stat">${orders.length > 0 ? ((orders.filter(o=>o.status==='refunded').length / orders.length) * 100).toFixed(1) : '0.0'}%</div>
        <div class="admin-stat-label">${orders.filter(o=>o.status==='refunded').length} refunds</div>
      </div>
    </div>

    <!-- Pricing Management -->
    <div class="admin-card" style="margin-top:32px;">
      <div class="admin-card-title">ğŸ’° Pricing Management</div>
      <p style="font-size:14px;color:var(--text-secondary);margin-bottom:16px;">Edit prices in real-time. Changes apply immediately to the storefront.</p>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;">
        ${PRICING.map(p => `
          <div style="padding:16px;background:var(--bg-deep);border:1px solid var(--border);border-radius:12px;">
            <div style="font-size:13px;color:var(--gold);font-weight:600;">${p.name}</div>
            <div class="form-group" style="margin:12px 0 0;">
              <label class="form-label">Price (USD)</label>
              <input type="number" class="form-input" value="${p.price}" step="0.01" style="padding:10px;" id="admin-price-${p.id}">
            </div>
            <div class="form-group" style="margin:8px 0 0;">
              <label class="form-label">Original Price</label>
              <input type="number" class="form-input" value="${p.orig}" step="0.01" style="padding:10px;" id="admin-orig-${p.id}">
            </div>
          </div>
        `).join('')}
      </div>
      <button class="btn btn-primary btn-sm" style="margin-top:16px;" onclick="savePricing()">Save Prices</button>
    </div>

    <!-- Theme Management (REAL SALES DATA) -->
    <div class="admin-card" style="margin-top:24px;">
      <div class="admin-card-title">ğŸ­ Theme Management â€” Live Sales Data</div>
      <table class="admin-table">
        <thead><tr><th>Theme</th><th>Status</th><th>Sales (Delivered)</th><th>Revenue</th><th>Action</th></tr></thead>
        <tbody>
          ${THEMES.map(t => {
            const sales = themeSales[t.id] || 0;
            const themeOrders = OrdersDB.getByTheme(t.id);
            const themeRevenue = themeOrders.reduce((s, o) => s + (parseFloat(o.amount) || 0), 0);
            return `<tr>
              <td>${t.emoji} ${t.title}</td>
              <td><span style="color:#4CAF50;">â— Active</span></td>
              <td><strong style="color:var(--text-primary);">${sales}</strong></td>
              <td>$${themeRevenue.toFixed(2)}</td>
              <td><button class="btn btn-secondary btn-sm" style="padding:6px 12px;font-size:12px;" onclick="alert('Theme editor coming soon. Edit theme data in the source code.')">Edit</button></td>
            </tr>`;
          }).join('')}
        </tbody>
        <tfoot>
          <tr style="border-top:2px solid var(--border-hover);">
            <td style="font-weight:600;color:var(--text-primary);">Total</td>
            <td></td>
            <td><strong style="color:var(--gold);">${totalDelivered}</strong></td>
            <td><strong style="color:var(--gold);">$${deliveredOrders.reduce((s,o) => s + (parseFloat(o.amount)||0), 0).toFixed(2)}</strong></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Recent Orders (REAL DATA) -->
    <div class="admin-card" style="margin-top:24px;">
      <div class="admin-card-title">ğŸ“§ Recent Orders â€” Live Data</div>
      ${recentOrders.length === 0 ? `
        <div style="text-align:center;padding:40px;color:var(--text-muted);">
          <div style="font-size:32px;margin-bottom:12px;">ğŸ“­</div>
          <div>No orders yet. Orders will appear here as customers complete purchases.</div>
        </div>
      ` : `
        <div style="max-height:400px;overflow-y:auto;">
          <table class="admin-table">
            <thead><tr><th>Date</th><th>Order ID</th><th>Email</th><th>Theme</th><th>Tier</th><th>Players</th><th>Amount</th><th>Status</th></tr></thead>
            <tbody>
              ${recentOrders.map(o => {
                const d = new Date(o.date);
                const dateStr = d.toLocaleDateString('en-US', {month:'short', day:'numeric', hour:'2-digit', minute:'2-digit'});
                const statusColors = { pending:'#F59E0B', paid:'#2196F3', generating:'#9C27B0', delivered:'#4CAF50', refunded:'#F44336', failed:'#F44336' };
                const statusIcons = { pending:'â³', paid:'ğŸ’³', generating:'âš¡', delivered:'âœ“', refunded:'â†©', failed:'âœ—' };
                return `<tr>
                  <td style="white-space:nowrap;">${dateStr}</td>
                  <td><code style="font-size:12px;color:var(--gold);">${o.id}</code></td>
                  <td>${o.email || 'â€”'}</td>
                  <td>${o.themeEmoji || ''} ${o.themeName || o.theme || 'â€”'}</td>
                  <td>${o.tierName || o.tier || 'â€”'}</td>
                  <td>${o.playerCount || 'â€”'}</td>
                  <td>$${parseFloat(o.amount || 0).toFixed(2)}</td>
                  <td><span style="color:${statusColors[o.status] || '#999'};">${statusIcons[o.status] || '?'} ${o.status}</span></td>
                </tr>`;
              }).join('')}
            </tbody>
          </table>
        </div>
      `}
    </div>

    <!-- Site Settings (FUNCTIONAL â€” saves to localStorage, loads into app) -->
    <div class="admin-card" style="margin-top:24px;">
      <div class="admin-card-title">âš™ï¸ Site Settings & API Keys</div>
      <p style="font-size:13px;color:var(--text-secondary);margin-bottom:16px;">
        Enter your API keys below. They are stored in your browser's localStorage and activate real payment processing and AI generation when saved.
        <br><span style="color:var(--gold);">âš ï¸ For production: move API keys to a secure backend server. Never expose secret keys in client-side code.</span>
      </p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px;">
        <div class="form-group">
          <label class="form-label">Business Email</label>
          <input type="email" class="form-input" value="${Settings.getBusinessEmail()}" id="admin-email">
        </div>
        <div class="form-group">
          <label class="form-label">Stripe Secret Key ${status.stripe ? '<span style="color:#4CAF50;">â— Connected</span>' : '<span style="color:#F44336;">â—‹ Not set</span>'}</label>
          <input type="password" class="form-input" value="${Settings.getStripeKey()}" placeholder="sk_live_..." id="admin-stripe">
          <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Enables real credit card payments via Stripe Checkout</div>
        </div>
        <div class="form-group">
          <label class="form-label">PayPal Client ID ${status.paypal ? '<span style="color:#4CAF50;">â— Connected</span>' : '<span style="color:#F44336;">â—‹ Not set</span>'}</label>
          <input type="password" class="form-input" value="${Settings.getPayPalClientId()}" placeholder="AX..." id="admin-paypal">
          <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Enables PayPal checkout buttons</div>
        </div>
        <div class="form-group">
          <label class="form-label">Claude API Key ${status.claude ? '<span style="color:#4CAF50;">â— Connected</span>' : '<span style="color:#F44336;">â—‹ Not set</span>'}</label>
          <input type="password" class="form-input" value="${Settings.getClaudeKey()}" placeholder="sk-ant-api03-..." id="admin-claude">
          <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Enables real AI mystery generation via Anthropic API</div>
        </div>
      </div>
      <button class="btn btn-primary btn-sm" style="margin-top:16px;" onclick="saveSettings()">Save All Settings</button>
      <span id="settings-save-status" style="margin-left:12px;font-size:13px;color:#4CAF50;display:none;">âœ“ Saved & activated!</span>
    </div>

    <!-- Analytics (REAL DATA) -->
    <div class="admin-card" style="margin-top:24px;">
      <div class="admin-card-title">ğŸ“Š Analytics â€” Real Data</div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-top:16px;">
        <div style="text-align:center;"><div style="font-size:24px;font-weight:700;color:var(--gold);">${OrdersDB.getCount(7)}</div><div style="font-size:12px;color:var(--text-muted);">Kits (7 days)</div></div>
        <div style="text-align:center;"><div style="font-size:24px;font-weight:700;color:var(--gold);">$${revenue7d.toFixed(2)}</div><div style="font-size:12px;color:var(--text-muted);">Revenue (7 days)</div></div>
        <div style="text-align:center;"><div style="font-size:24px;font-weight:700;color:var(--gold);">${totalDelivered}</div><div style="font-size:12px;color:var(--text-muted);">All-Time Kits</div></div>
        <div style="text-align:center;"><div style="font-size:24px;font-weight:700;color:var(--gold);">$${deliveredOrders.reduce((s,o)=>s+(parseFloat(o.amount)||0),0).toFixed(2)}</div><div style="font-size:12px;color:var(--text-muted);">All-Time Revenue</div></div>
      </div>
    </div>

    <!-- Danger Zone -->
    <div style="margin-top:40px;padding:24px;border:1px solid rgba(139,32,32,0.3);border-radius:12px;background:rgba(139,32,32,0.05);">
      <div style="font-size:14px;font-weight:600;color:var(--blood-light);margin-bottom:8px;">âš ï¸ Danger Zone</div>
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <button class="btn btn-secondary btn-sm" style="border-color:rgba(139,32,32,0.3);color:var(--blood-light);" onclick="if(confirm('Clear ALL orders data? This cannot be undone.')){localStorage.removeItem('cc_orders');renderAdmin();}">Clear All Orders</button>
        <button class="btn btn-secondary btn-sm" style="border-color:rgba(139,32,32,0.3);color:var(--blood-light);" onclick="if(confirm('Reset ALL settings including API keys?')){localStorage.removeItem('cc_settings');renderAdmin();}">Reset Settings</button>
        <button class="btn btn-secondary btn-sm" style="border-color:rgba(139,32,32,0.3);color:var(--blood-light);" onclick="exportData()">Export All Data (JSON)</button>
      </div>
    </div>
  `;
}

function savePricing() {
  PRICING.forEach(p => {
    const priceEl = document.getElementById(`admin-price-${p.id}`);
    const origEl = document.getElementById(`admin-orig-${p.id}`);
    if (priceEl) p.price = parseFloat(priceEl.value);
    if (origEl) p.orig = parseFloat(origEl.value);
  });
  // Persist pricing to localStorage
  Settings.save({ pricing: PRICING.map(p => ({ id:p.id, price:p.price, orig:p.orig })) });
  renderPricing();
  alert('Prices updated and saved!');
}

function saveSettings() {
  const settings = {
    business_email: document.getElementById('admin-email').value,
    stripe_key: document.getElementById('admin-stripe').value,
    paypal_client_id: document.getElementById('admin-paypal').value,
    claude_key: document.getElementById('admin-claude').value
  };
  Settings.save(settings);

  // Re-initialize APIs with new keys
  stripeInstance = null; // Reset so it re-inits
  if (Settings.isStripeConfigured()) initStripe();
  if (Settings.isPayPalConfigured()) initPayPal();

  // Show success feedback
  const statusEl = document.getElementById('settings-save-status');
  statusEl.style.display = 'inline';
  setTimeout(() => { statusEl.style.display = 'none'; }, 3000);

  // Re-render admin to update status indicators
  setTimeout(() => renderAdmin(), 500);
}

function exportData() {
  const data = {
    orders: OrdersDB.getAll(),
    settings: { ...Settings.get(), stripe_key: '***HIDDEN***', paypal_client_id: '***HIDDEN***', claude_key: '***HIDDEN***' },
    pricing: PRICING.map(p => ({ id:p.id, name:p.name, price:p.price, orig:p.orig })),
    exported_at: new Date().toISOString()
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `akai-veritas-export-${new Date().toISOString().slice(0,10)}.json`;
  a.click();
  URL.revokeObjectURL(url);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AKAI VERITAS â€” SECURE ADMIN + LOCAL GAME ENGINE
//  All API keys encrypted with AES-256-GCM derived from admin password
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€ Crypto helpers (Web Crypto API â€” native, no libraries) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AV_CRYPTO = {
  async deriveKey(password, salt) {
    const enc = new TextEncoder();
    const keyMaterial = await crypto.subtle.importKey(
      'raw', enc.encode(password), 'PBKDF2', false, ['deriveKey']
    );
    return crypto.subtle.deriveKey(
      { name: 'PBKDF2', salt: enc.encode(salt), iterations: 100000, hash: 'SHA-256' },
      keyMaterial, { name: 'AES-GCM', length: 256 }, false, ['encrypt', 'decrypt']
    );
  },
  async encrypt(text, password) {
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const key = await this.deriveKey(password, 'akai-veritas-salt-v1');
    const enc = new TextEncoder();
    const ct = await crypto.subtle.encrypt({ name: 'AES-GCM', iv }, key, enc.encode(text));
    const buf = new Uint8Array(iv.byteLength + ct.byteLength);
    buf.set(iv, 0); buf.set(new Uint8Array(ct), iv.byteLength);
    return btoa(String.fromCharCode(...buf));
  },
  async decrypt(b64, password) {
    try {
      const buf = Uint8Array.from(atob(b64), c => c.charCodeAt(0));
      const iv = buf.slice(0, 12), ct = buf.slice(12);
      const key = await this.deriveKey(password, 'akai-veritas-salt-v1');
      const pt = await crypto.subtle.decrypt({ name: 'AES-GCM', iv }, key, ct);
      return new TextDecoder().decode(pt);
    } catch { return null; }
  },
  async sha256(text) {
    const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(text));
    return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
  }
};

// â”€â”€ Admin Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ADMIN2 = {
  SESSION_KEY: 'av_admin_session',
  HASH_KEY:    'av_admin_hash',
  VAULT_KEY:   'av_vault',
  ATTEMPTS_KEY:'av_login_attempts',
  LOCKOUT_KEY: 'av_lockout_until',
  MAX_ATTEMPTS: 5,
  LOCKOUT_MS:  15 * 60 * 1000,
  _sessionPw: null,

  isLoggedIn() {
    const s = sessionStorage.getItem(this.SESSION_KEY);
    return s === 'authenticated';
  },
  getSessionPw() { return this._sessionPw; },

  async login(password) {
    // Check lockout
    const lockUntil = parseInt(localStorage.getItem(this.LOCKOUT_KEY) || '0');
    if (Date.now() < lockUntil) {
      const remaining = Math.ceil((lockUntil - Date.now()) / 1000);
      return { ok: false, locked: true, remaining };
    }

    const storedHash = localStorage.getItem(this.HASH_KEY);
    if (!storedHash) {
      // First time setup â€” set this password as admin
      const hash = await AV_CRYPTO.sha256('akai-veritas-2026-' + password);
      localStorage.setItem(this.HASH_KEY, hash);
      sessionStorage.setItem(this.SESSION_KEY, 'authenticated');
      this._sessionPw = password;
      localStorage.removeItem(this.ATTEMPTS_KEY);
      return { ok: true, firstTime: true };
    }

    const hash = await AV_CRYPTO.sha256('akai-veritas-2026-' + password);
    if (hash === storedHash) {
      sessionStorage.setItem(this.SESSION_KEY, 'authenticated');
      this._sessionPw = password;
      localStorage.removeItem(this.ATTEMPTS_KEY);
      localStorage.removeItem(this.LOCKOUT_KEY);
      return { ok: true };
    } else {
      let attempts = parseInt(localStorage.getItem(this.ATTEMPTS_KEY) || '0') + 1;
      localStorage.setItem(this.ATTEMPTS_KEY, attempts);
      if (attempts >= this.MAX_ATTEMPTS) {
        localStorage.setItem(this.LOCKOUT_KEY, Date.now() + this.LOCKOUT_MS);
        localStorage.setItem(this.ATTEMPTS_KEY, '0');
        return { ok: false, locked: true, remaining: this.LOCKOUT_MS / 1000 };
      }
      return { ok: false, attemptsLeft: this.MAX_ATTEMPTS - attempts };
    }
  },

  logout() {
    sessionStorage.removeItem(this.SESSION_KEY);
    this._sessionPw = null;
  },

  async saveVault(data) {
    const pw = this._sessionPw;
    if (!pw) return;
    const encrypted = await AV_CRYPTO.encrypt(JSON.stringify(data), pw);
    localStorage.setItem(this.VAULT_KEY, encrypted);
  },

  async loadVault() {
    const pw = this._sessionPw;
    if (!pw) return {};
    const enc = localStorage.getItem(this.VAULT_KEY);
    if (!enc) return {};
    const dec = await AV_CRYPTO.decrypt(enc, pw);
    if (!dec) return {};
    try { return JSON.parse(dec); } catch { return {}; }
  },

  async changePassword(currentPw, newPw) {
    if (newPw.length < 12) return { ok: false, msg: 'Minimum 12 characters required.' };
    const currentHash = await AV_CRYPTO.sha256('akai-veritas-2026-' + currentPw);
    const storedHash = localStorage.getItem(this.HASH_KEY);
    if (currentHash !== storedHash) return { ok: false, msg: 'Current password incorrect.' };
    // Re-encrypt vault with new password
    const vault = await this.loadVault();
    const newHash = await AV_CRYPTO.sha256('akai-veritas-2026-' + newPw);
    localStorage.setItem(this.HASH_KEY, newHash);
    this._sessionPw = newPw;
    await this.saveVault(vault);
    return { ok: true, msg: 'âœ“ Password updated successfully.' };
  }
};

// â”€â”€ UI: Login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openAdmin2() {
  if (ADMIN2.isLoggedIn() && ADMIN2.getSessionPw()) {
    admin2OpenPanel();
  } else {
    document.getElementById('admin2LoginOverlay').classList.add('open');
    document.getElementById('admin2PwInput').value = '';
    document.getElementById('admin2LoginError').classList.remove('visible');
    admin2CheckLockout();
    setTimeout(() => document.getElementById('admin2PwInput').focus(), 100);
  }
}

function admin2CloseLogin() {
  document.getElementById('admin2LoginOverlay').classList.remove('open');
}

function admin2TogglePw() {
  const inp = document.getElementById('admin2PwInput');
  inp.type = inp.type === 'password' ? 'text' : 'password';
}

let _lockTimer = null;
function admin2CheckLockout() {
  const lockUntil = parseInt(localStorage.getItem(ADMIN2.LOCKOUT_KEY) || '0');
  const lockout = document.getElementById('admin2Lockout');
  const loginBtn = document.querySelector('#admin2LoginOverlay .btn-primary');
  if (Date.now() < lockUntil) {
    lockout.classList.add('visible');
    if (loginBtn) loginBtn.disabled = true;
    if (_lockTimer) clearInterval(_lockTimer);
    _lockTimer = setInterval(() => {
      const rem = Math.max(0, Math.ceil((lockUntil - Date.now()) / 1000));
      const m = String(Math.floor(rem / 60)).padStart(2,'0');
      const s = String(rem % 60).padStart(2,'0');
      const el = document.getElementById('admin2LockTimer');
      if (el) el.textContent = `${m}:${s}`;
      if (rem <= 0) {
        clearInterval(_lockTimer);
        lockout.classList.remove('visible');
        if (loginBtn) loginBtn.disabled = false;
      }
    }, 1000);
  } else {
    lockout.classList.remove('visible');
    if (loginBtn) loginBtn.disabled = false;
  }
}

async function admin2Login() {
  const pw = document.getElementById('admin2PwInput').value;
  if (!pw) return;
  const lockUntil = parseInt(localStorage.getItem(ADMIN2.LOCKOUT_KEY) || '0');
  if (Date.now() < lockUntil) return;
  const result = await ADMIN2.login(pw);
  if (result.ok) {
    document.getElementById('admin2LoginOverlay').classList.remove('open');
    if (result.firstTime) alert('âœ“ First login! This password is now your admin password. Store it safely.');
    admin2OpenPanel();
  } else if (result.locked) {
    document.getElementById('admin2LoginError').classList.remove('visible');
    document.getElementById('admin2Lockout').classList.add('visible');
    admin2CheckLockout();
  } else {
    const err = document.getElementById('admin2LoginError');
    err.textContent = `Incorrect password. ${result.attemptsLeft} attempt(s) remaining.`;
    err.classList.add('visible');
    document.getElementById('admin2PwInput').value = '';
    document.getElementById('admin2PwInput').focus();
  }
}

// â”€â”€ UI: Panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function admin2OpenPanel() {
  document.getElementById('admin2Panel').classList.add('open');
  document.getElementById('admin2SessionLabel').textContent = 'ğŸŸ¢ Session active';
  await admin2LoadAll();
  admin2RefreshStats();
}

function admin2Logout() {
  ADMIN2.logout();
  document.getElementById('admin2Panel').classList.remove('open');
}

function admin2ToggleKey(inputId, btn) {
  const inp = document.getElementById(inputId);
  inp.type = inp.type === 'password' ? 'text' : 'password';
  btn.textContent = inp.type === 'password' ? 'ğŸ‘' : 'ğŸ”’';
}

// â”€â”€ Save / Load all settings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function admin2SaveAll() {
  const vault = {
    stripeKey:     document.getElementById('a2StripeKey').value.trim(),
    paypalKey:     document.getElementById('a2PaypalKey').value.trim(),
    claudeKey:     document.getElementById('a2ClaudeKey').value.trim(),
    mapsKey:       document.getElementById('a2MapsKey').value.trim(),
    lgEnabled:     document.getElementById('a2LGEnabled').checked,
    lgPrice:       document.getElementById('a2LGPrice').value,
    lgMaxPlayers:  document.getElementById('a2LGMaxPlayers').value,
    businessEmail: document.getElementById('a2BusinessEmail').value.trim(),
    domain:        document.getElementById('a2Domain').value.trim(),
  };
  await ADMIN2.saveVault(vault);
  admin2UpdateDots(vault);
  admin2ApplyLGSection(vault);
  // Save non-sensitive settings publicly for app use (no keys!)
  const publicCfg = { lgEnabled: vault.lgEnabled, lgPrice: vault.lgPrice, lgMaxPlayers: vault.lgMaxPlayers, domain: vault.domain };
  localStorage.setItem('av_public_cfg', JSON.stringify(publicCfg));
  const msg = document.getElementById('admin2SaveAllMsg');
  msg.style.display = 'inline';
  setTimeout(() => msg.style.display = 'none', 3000);
}

async function admin2LoadAll() {
  const vault = await ADMIN2.loadVault();
  if (vault.stripeKey)    document.getElementById('a2StripeKey').value    = vault.stripeKey;
  if (vault.paypalKey)    document.getElementById('a2PaypalKey').value    = vault.paypalKey;
  if (vault.claudeKey)    document.getElementById('a2ClaudeKey').value    = vault.claudeKey;
  if (vault.mapsKey)      document.getElementById('a2MapsKey').value      = vault.mapsKey;
  if (vault.lgPrice!=null)document.getElementById('a2LGPrice').value      = vault.lgPrice;
  if (vault.lgMaxPlayers) document.getElementById('a2LGMaxPlayers').value = vault.lgMaxPlayers;
  if (vault.businessEmail)document.getElementById('a2BusinessEmail').value= vault.businessEmail;
  if (vault.domain)       document.getElementById('a2Domain').value       = vault.domain;
  document.getElementById('a2LGEnabled').checked = !!vault.lgEnabled;
  admin2UpdateDots(vault);
  admin2UpdateLGStatus();
  return vault;
}

function admin2UpdateDots(v) {
  const set = (dotId, msgId, ok, label) => {
    const dot = document.getElementById(dotId), msg = document.getElementById(msgId);
    if (!dot || !msg) return;
    dot.className = 'admin2-dot ' + (ok ? 'ok' : 'err');
    msg.style.color = ok ? '#4CAF50' : '#F44336';
    msg.textContent = ok ? 'âœ“ Configured' : 'Not configured';
  };
  set('a2StripeDot',  'a2StripeMsg',  v.stripeKey?.startsWith('sk'));
  set('a2PaypalDot',  'a2PaypalMsg',  !!v.paypalKey);
  set('a2ClaudeDot',  'a2ClaudeMsg',  v.claudeKey?.startsWith('sk-'));
  set('a2MapsDot',    'a2MapsMsg',    v.mapsKey?.startsWith('AIza'));

  const pill = (id, ok, label) => {
    const el = document.getElementById(id);
    if (el) el.innerHTML = `<span class="admin2-status-pill ${ok?'ok':'warn'}">${ok?'Active':'Not set'}</span>`;
  };
  pill('a2StripeStatus',  v.stripeKey?.startsWith('sk'));
  pill('a2PaypalStatus',  !!v.paypalKey);
  pill('a2ClaudeStatus',  v.claudeKey?.startsWith('sk-'));
  pill('a2MapsStatus',    v.mapsKey?.startsWith('AIza'));
  const lgOk = !!v.lgEnabled;
  const lgEl = document.getElementById('a2LGStatus');
  if (lgEl) lgEl.innerHTML = `<span class="admin2-status-pill ${lgOk?'ok':'warn'}">${lgOk?'Enabled':'Disabled'}</span>`;
  const lgCell = document.getElementById('a2LGStatusCell');
  if (lgCell) lgCell.innerHTML = `<span class="admin2-status-pill ${lgOk?'ok':'warn'}">${lgOk?'Enabled':'Disabled'}</span>`;
}

function admin2UpdateLGStatus() {
  const enabled = document.getElementById('a2LGEnabled').checked;
  const lgEl = document.getElementById('a2LGStatus');
  if (lgEl) lgEl.innerHTML = `<span class="admin2-status-pill ${enabled?'ok':'warn'}">${enabled?'Enabled':'Disabled'}</span>`;
}

function admin2ApplyLGSection(vault) {
  const section = document.querySelector('[data-lg-section]');
  if (!section) return;
  section.style.display = vault.lgEnabled ? 'block' : 'none';
  // Update nav link visibility
  const navLink = document.getElementById('lgNavLink');
  if (navLink) navLink.style.display = vault.lgEnabled ? 'list-item' : 'none';
  const mobileLink = document.getElementById('lgMobileNavLink');
  if (mobileLink) mobileLink.style.display = vault.lgEnabled ? 'block' : 'none';
  // Update price display
  if (vault.lgEnabled) {
    const price = parseFloat(vault.lgPrice || 0);
    document.getElementById('lgBetaLabel').textContent = price > 0 ? `â‚¬${price}` : 'Free';
    document.getElementById('lgPriceLabel').textContent = price > 0 ? 'Per Game' : 'Beta Access';
  }
}

function admin2RefreshStats() {
  try {
    const orders = JSON.parse(localStorage.getItem('ccorders') || '[]');
    const delivered = orders.filter(o => o.status === 'delivered');
    const revenue = delivered.reduce((s, o) => s + parseFloat(o.amount || 0), 0);
    document.getElementById('a2StatRevenue').textContent = '$' + revenue.toFixed(2);
    document.getElementById('a2StatKits').textContent = delivered.length;
    const lgGames = parseInt(localStorage.getItem('av_lg_games') || '0');
    document.getElementById('a2StatLocal').textContent = lgGames;
    document.getElementById('a2LGGames').textContent = lgGames;
    document.getElementById('a2LGLocations').textContent = localStorage.getItem('av_lg_locations') || '0';
    // Recent orders table
    const recent = orders.slice(0, 10);
    if (recent.length > 0) {
      document.getElementById('a2OrdersTable').innerHTML = `
        <table class="admin2-table">
          <tr><th>ID</th><th>Theme</th><th>Amount</th><th>Status</th><th>Date</th></tr>
          ${recent.map(o => `<tr>
            <td style="font-family:monospace;">${o.id || 'â€”'}</td>
            <td>${o.theme || 'â€”'}</td>
            <td style="color:var(--gold);">$${parseFloat(o.amount||0).toFixed(2)}</td>
            <td><span class="admin2-status-pill ${o.status==='delivered'?'ok':o.status==='pending'?'warn':'err'}">${o.status||'â€”'}</span></td>
            <td style="font-size:12px;">${o.date ? new Date(o.date).toLocaleDateString() : 'â€”'}</td>
          </tr>`).join('')}
        </table>`;
    }
  } catch(e) { console.error(e); }
}

async function admin2ChangePassword() {
  const cur  = document.getElementById('a2PwCurrent').value;
  const nw   = document.getElementById('a2PwNew').value;
  const conf = document.getElementById('a2PwConfirm').value;
  const msg  = document.getElementById('a2PwMsg');
  if (nw !== conf) { msg.style.color='#F44336'; msg.textContent='Passwords do not match.'; return; }
  const result = await ADMIN2.changePassword(cur, nw);
  msg.style.color = result.ok ? '#4CAF50' : '#F44336';
  msg.textContent = result.msg;
  if (result.ok) { document.getElementById('a2PwCurrent').value=''; document.getElementById('a2PwNew').value=''; document.getElementById('a2PwConfirm').value=''; }
}

function admin2ClearAll() {
  if (!confirm('âš ï¸ WARNING: This will delete ALL stored data including API keys, orders, and settings. This cannot be undone.\n\nType DELETE to confirm.')) return;
  const key = prompt('Type DELETE to confirm:');
  if (key !== 'DELETE') return;
  localStorage.clear();
  sessionStorage.clear();
  alert('All data cleared. Reload the page.');
  location.reload();
}

// â”€â”€ LOCAL GAME ENGINE (keys loaded securely from vault) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LG = {
  map:null, marker:null, lat:null, lng:null, locationName:'', locationData:{},
  players:[{name:'Player 1'},{name:'Player 2'}], mapsLoaded:false,
  _mapsKey: null, _aiKey: null, _maxPlayers: 10,

  async init() {
    // Load public config (no keys)
    try {
      const pub = JSON.parse(localStorage.getItem('av_public_cfg') || '{}');
      this._maxPlayers = parseInt(pub.lgMaxPlayers || 10);
    } catch {}
    // Load keys from vault only if admin is logged in
    if (ADMIN2.isLoggedIn() && ADMIN2.getSessionPw()) {
      const vault = await ADMIN2.loadVault();
      this._mapsKey = vault.mapsKey || null;
      this._aiKey   = vault.claudeKey || null;
    }
  },

  hasMapsKey() { return this._mapsKey && this._mapsKey.startsWith('AIza'); },
  hasAIKey()   { return this._aiKey   && this._aiKey.startsWith('sk-'); },
};

// This function is called when Local Game section loads â€” fetches keys securely
async function lgInitSecure() {
  await LG.init();
  lgRenderPlayers();
  if (LG.hasMapsKey()) lgInitMap();
  lgCheckReady();
}

// Public init â€” no admin needed for basic UI, keys fetched only at generation time
async function lgGetKeysForGeneration() {
  // If admin is active in this session, use vault keys
  if (ADMIN2.isLoggedIn() && ADMIN2.getSessionPw()) {
    const vault = await ADMIN2.loadVault();
    LG._mapsKey = vault.mapsKey || null;
    LG._aiKey   = vault.claudeKey || null;
    return true;
  }
  // Otherwise keys not available â€” generation blocked
  return false;
}

function lgRenderPlayers() {
  const list = document.getElementById('lgPlayerList');
  if (!list) return;
  const colors = ['#C8A96E','#C44040','#64B5F6','#81C784','#FFB74D','#BA68C8','#4DD0E1','#F06292'];
  list.innerHTML = LG.players.map((p,i) => `
    <div class="localgame-player-item">
      <div class="localgame-player-dot" style="background:${colors[i%colors.length]}"></div>
      <input type="text" value="${p.name}" oninput="LG.players[${i}].name=this.value"
        style="background:none;border:none;outline:none;color:var(--text-primary);font-size:14px;flex:1;font-family:var(--font-body);" placeholder="Player name"/>
      ${LG.players.length>1?`<button onclick="lgRemovePlayer(${i})" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:16px;">Ã—</button>`:''}
    </div>`).join('');
}
function lgAddPlayer() { if(LG.players.length>=LG._maxPlayers){alert('Max '+LG._maxPlayers+' players');return;} LG.players.push({name:'Player '+(LG.players.length+1)});lgRenderPlayers(); }
function lgRemovePlayer(i) { if(LG.players.length<=1)return; LG.players.splice(i,1); lgRenderPlayers(); }

function lgInitMap() {
  if (!LG.hasMapsKey() || LG.mapsLoaded) return;
  const s = document.createElement('script');
  s.src = `https://maps.googleapis.com/maps/api/js?key=${LG._mapsKey}&libraries=places&callback=lgMapCallback`;
  s.async = true;
  s.onerror = () => { const el = document.querySelector('#lgMapOverlay .localgame-map-text'); if(el) el.textContent='Map API key invalid'; };
  document.head.appendChild(s);
}
function lgMapCallback() {
  LG.mapsLoaded = true;
  const center = {lat:48.8916, lng:18.0449};
  LG.map = new google.maps.Map(document.getElementById('localGameMap'), {
    zoom:15, center,
    styles:[{elementType:'geometry',stylers:[{color:'#0e0e12'}]},{elementType:'labels.text.stroke',stylers:[{color:'#08080a'}]},{elementType:'labels.text.fill',stylers:[{color:'#8a8070'}]},{featureType:'road',elementType:'geometry',stylers:[{color:'#1a1a20'}]},{featureType:'road.highway',elementType:'geometry',stylers:[{color:'#222230'}]},{featureType:'water',elementType:'geometry',stylers:[{color:'#050508'}]},{featureType:'poi',elementType:'labels.text.fill',stylers:[{color:'#C8A96E'}]}],
    disableDefaultUI:false, zoomControl:true, mapTypeControl:false, streetViewControl:false
  });
  const ov = document.getElementById('lgMapOverlay');
  if (ov) ov.classList.add('hidden');
  LG.map.addListener('click', e => lgSetLocation(e.latLng.lat(), e.latLng.lng()));
}

function lgGetLocation() {
  const btn = document.getElementById('lgLocBtn');
  btn.textContent = 'â³ Getting location...'; btn.disabled = true;
  if (!navigator.geolocation) { btn.textContent='âŒ Not supported'; btn.disabled=false; return; }
  navigator.geolocation.getCurrentPosition(
    pos => { btn.textContent='âœ“ Found!'; btn.disabled=false; lgSetLocation(pos.coords.latitude,pos.coords.longitude); if(!LG.mapsLoaded&&LG.hasMapsKey())lgInitMap(); setTimeout(()=>btn.textContent='ğŸ“ Update Location',3000); },
    err => { btn.textContent='ğŸ“ Use My Location'; btn.disabled=false; alert('Error: '+err.message); },
    {enableHighAccuracy:true, timeout:10000}
  );
}
function lgSearchLocation() {
  const q = document.getElementById('lgSearchInput').value.trim(); if(!q)return;
  if (LG.mapsLoaded && window.google) {
    new google.maps.Geocoder().geocode({address:q},(results,status)=>{ if(status==='OK'){const l=results[0].geometry.location; lgSetLocation(l.lat(),l.lng(),results[0].formatted_address); LG.map.setCenter(l);} else alert('Not found.'); });
  } else {
    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&limit=1`)
      .then(r=>r.json()).then(data=>{ if(data.length>0) lgSetLocation(parseFloat(data[0].lat),parseFloat(data[0].lon),data[0].display_name); else alert('Not found.'); }).catch(()=>alert('Search failed.'));
  }
}
function lgSetLocation(lat,lng,name) {
  LG.lat=lat; LG.lng=lng;
  if(LG.mapsLoaded&&window.google){
    const pos={lat,lng};
    if(!LG.marker){LG.marker=new google.maps.Marker({position:pos,map:LG.map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:'#C8A96E',fillOpacity:1,strokeColor:'#08080A',strokeWeight:3},animation:google.maps.Animation.DROP});}
    else LG.marker.setPosition(pos);
    LG.map.panTo(pos);
    new google.maps.Geocoder().geocode({location:pos},(results,status)=>{ if(status==='OK'&&results[0]){LG.locationName=name||results[0].formatted_address; lgShowLocationBox(lat,lng,LG.locationName); lgFetchPlaces(lat,lng);} });
  } else { LG.locationName=name||`${lat.toFixed(4)}, ${lng.toFixed(4)}`; lgShowLocationBox(lat,lng,LG.locationName); lgFetchPlacesNominatim(lat,lng); }
  lgCheckReady();
}
function lgShowLocationBox(lat,lng,name) {
  const box=document.getElementById('lgLocationBox'); if(!box)return;
  box.style.display='block';
  document.getElementById('lgLocationName').textContent=name;
  document.getElementById('lgLocationCoords').textContent=`${lat.toFixed(6)}, ${lng.toFixed(6)}`;
}
function lgFetchPlaces(lat,lng) {
  if(!LG.mapsLoaded||!window.google)return;
  new google.maps.places.PlacesService(LG.map).nearbySearch({location:new google.maps.LatLng(lat,lng),radius:500,type:['establishment','point_of_interest']},(results,status)=>{
    if(status===google.maps.places.PlacesServiceStatus.OK){LG.locationData.places=results.slice(0,15).map(p=>({name:p.name,types:p.types}));lgRenderLocationTags();lgCheckReady();}
  });
}
async function lgFetchPlacesNominatim(lat,lng) {
  try {
    const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`);
    const data=await r.json(); LG.locationData.address=data.address||{};
    const tags=[]; if(data.address?.city)tags.push(data.address.city); if(data.address?.town)tags.push(data.address.town); if(data.address?.road)tags.push(data.address.road); if(data.address?.country)tags.push(data.address.country);
    LG.locationData.places=tags.map(t=>({name:t,types:['locality']})); lgRenderLocationTags(); lgCheckReady();
  } catch { lgCheckReady(); }
}
function lgRenderLocationTags() { const c=document.getElementById('lgLocationTags'); if(!c)return; const names=[...new Set((LG.locationData.places||[]).map(p=>p.name).slice(0,6))]; c.innerHTML=names.map(n=>`<span class="localgame-tag">${n}</span>`).join(''); }
function lgCheckReady() {
  const btn=document.getElementById('lgGenerateBtn'),t=document.getElementById('lgGenerateBtnText');
  if(!btn)return;
  const ready=LG.lat!==null;
  btn.disabled=!ready;
  if(ready) t.textContent='âœ¨ Generate Local Mystery';
  else t.textContent='ğŸ“ Select Location First';
}

async function lgGenerateGame() {
  if(!LG.lat) return;
  // Securely fetch keys at generation time
  const keysOk = await lgGetKeysForGeneration();
  if(!LG.hasAIKey()) {
    alert('âš ï¸ AI API key not configured.\n\nAdmin must configure the Claude/OpenAI key in the Admin Panel first.');
    return;
  }
  const btn=document.getElementById('lgGenerateBtn'), sp=document.getElementById('lgSpinner'), t=document.getElementById('lgGenerateBtnText');
  btn.disabled=true; sp.style.display='block'; t.textContent='Generating mystery...';
  const genre=document.getElementById('lgGenre').value, duration=document.getElementById('lgDuration').value;
  const players=LG.players.map(p=>p.name).filter(n=>n.trim()).join(', ');
  const placesStr=(LG.locationData.places||[]).map(p=>p.name).join(', ');
  const prompt=`You are AKAI VERITAS â€” master storyteller for location-based murder mystery games.\n\nLOCATION: ${LG.locationName}\nCOORDINATES: ${LG.lat.toFixed(4)}, ${LG.lng.toFixed(4)}\nNEARBY PLACES: ${placesStr||'Unknown area'}\nPLAYERS: ${players}\nNUMBER OF PLAYERS: ${LG.players.length}\nSTORY STYLE: ${genre}\nGAME DURATION: ${duration} minutes\n\nCreate a COMPLETE murder mystery for this exact real-world location. Reference actual street names and buildings.\n\nReturn ONLY valid JSON:\n{"title":"Mystery title max 8 words","tagline":"One dramatic teaser","victim":"Name and description","setting":"2-3 sentences as crime scene","murder_method":"How murdered","time_of_death":"When","characters":[{"player":"Player name","character_name":"In-game name","role":"Profession","motive":"Secret motive","alibi":"Their alibi","secret":"Private secret"}],"clues":[{"location":"Real nearby place","clue":"What players find there"}],"rounds":[{"round":1,"title":"Round title","action":"What happens"},{"round":2,"title":"Escalation","action":"Mid game"},{"round":3,"title":"Reveal","action":"Final confrontation"}],"solution":{"murderer":"Who did it","full_explanation":"Complete explanation"}}`;
  try {
    let result=null; const key=LG._aiKey;
    if(key.startsWith('sk-ant-')) {
      const r=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','x-api-key':key,'anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},body:JSON.stringify({model:'claude-opus-4-5',max_tokens:4000,messages:[{role:'user',content:prompt}]})});
      const d=await r.json(); result=d.content?.[0]?.text;
    } else if(key.startsWith('sk-')) {
      const r=await fetch('https://api.openai.com/v1/chat/completions',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${key}`},body:JSON.stringify({model:'gpt-4o',max_tokens:4000,messages:[{role:'user',content:prompt}],response_format:{type:'json_object'}})});
      const d=await r.json(); result=d.choices?.[0]?.message?.content;
    }
    if(!result) throw new Error('No response from AI');
    const jm=result.match(/\{[\s\S]*\}/); const story=JSON.parse(jm?jm[0]:result);
    lgRenderStory(story);
    // Track stats
    const g=parseInt(localStorage.getItem('av_lg_games')||'0')+1; localStorage.setItem('av_lg_games',g);
    const l=parseInt(localStorage.getItem('av_lg_locations')||'0')+1; localStorage.setItem('av_lg_locations',l);
  } catch(e) { console.error(e); alert('Generation failed: '+e.message); }
  finally { btn.disabled=false; sp.style.display='none'; t.textContent='ğŸ”„ Regenerate Mystery'; }
}

function lgRenderStory(story) {
  const out=document.getElementById('lgStoryOutput'); if(!out)return;
  out.classList.add('visible'); out.scrollIntoView({behavior:'smooth',block:'start'});
  document.getElementById('lgStoryTitle').textContent=story.title||'Untitled Mystery';
  document.getElementById('lgStoryLocationBadge').innerHTML=`ğŸ“ ${(LG.locationName||'').slice(0,40)}`;
  const ch=(story.characters||[]).map(c=>`<div class="localgame-clue-card"><div class="localgame-clue-label">ğŸ­ ${c.player} â€” ${c.character_name}</div><div class="localgame-clue-text"><strong style="color:var(--text-primary)">${c.role}</strong><br><em>Motive:</em> ${c.motive}<br><em>Alibi:</em> ${c.alibi}<br><em>Secret:</em> ${c.secret}</div></div>`).join('');
  const cl=(story.clues||[]).map(c=>`<div class="localgame-clue-card"><div class="localgame-clue-label">ğŸ” ${c.location}</div><div class="localgame-clue-text">${c.clue}</div></div>`).join('');
  const ro=(story.rounds||[]).map(r=>`<div class="localgame-clue-card"><div class="localgame-clue-label">â–¶ Round ${r.round}: ${r.title}</div><div class="localgame-clue-text">${r.action}</div></div>`).join('');
  document.getElementById('lgStoryBody').innerHTML=`<p style="font-family:var(--font-display);font-size:18px;font-style:italic;color:rgba(240,234,224,0.7);margin-bottom:24px;">"${story.tagline}"</p><h3>ğŸ—ºï¸ Crime Scene</h3><p>${story.setting}</p><p><strong style="color:var(--text-primary)">Victim:</strong> ${story.victim}</p><p><strong style="color:var(--text-primary)">Murder Method:</strong> ${story.murder_method}</p><p><strong style="color:var(--text-primary)">Time of Death:</strong> ${story.time_of_death}</p><h3>ğŸ­ Characters</h3>${ch}<h3>ğŸ” Clues & Locations</h3>${cl}<h3>ğŸ“‹ Game Rounds</h3>${ro}<h3 style="color:#C44040">ğŸ”’ Solution â€” Host Only</h3><div class="localgame-clue-card" style="border-color:rgba(139,32,32,0.3);background:rgba(139,32,32,0.04)"><div class="localgame-clue-label" style="color:#C44040">âš ï¸ SPOILER â€” Show after accusations</div><div class="localgame-clue-text"><strong style="color:var(--text-primary)">Murderer: ${story.solution?.murderer}</strong><br><br>${story.solution?.full_explanation}</div></div>`;
  document.getElementById('lgShareLink').textContent=`${window.location.href.split('#')[0]}#lg-${Date.now().toString(36)}`;
  document.getElementById('lgShareCard').style.display='block';
}
function lgCopyLink() { navigator.clipboard.writeText(document.getElementById('lgShareLink').textContent).then(()=>alert('âœ“ Copied!')); }
function lgPrintStory() { const c=document.getElementById('lgStoryOutput').innerHTML; const w=window.open('','_blank'); w.document.write(`<html><head><title>AKAI VERITAS Mystery</title><style>body{font-family:Georgia,serif;max-width:800px;margin:40px auto;color:#111;line-height:1.7;}h3{color:#8B2020;margin-top:28px;}.localgame-clue-card{background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:14px 18px;margin:10px 0;}.localgame-clue-label{font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:#8B2020;margin-bottom:6px;}</style></head><body>${c}</body></html>`); w.document.close(); w.print(); }

// â”€â”€ Apply public config on page load â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function avApplyPublicConfig() {
  try {
    const pub = JSON.parse(localStorage.getItem('av_public_cfg') || '{}');
    const section = document.querySelector('[data-lg-section]');
    if (section) section.style.display = pub.lgEnabled ? 'block' : 'none';
    const navLink = document.getElementById('lgNavLink');
    if (navLink) navLink.style.display = pub.lgEnabled ? 'list-item' : 'none';
    const mobileLink = document.getElementById('lgMobileNavLink');
    if (mobileLink) mobileLink.style.display = pub.lgEnabled ? 'block' : 'none';
    if (pub.lgEnabled) {
      const price = parseFloat(pub.lgPrice || 0);
      const bl = document.getElementById('lgBetaLabel');
      const pl = document.getElementById('lgPriceLabel');
      if(bl) bl.textContent = price > 0 ? `â‚¬${price}` : 'Free';
      if(pl) pl.textContent = price > 0 ? 'Per Game' : 'Beta Access';
      LG._maxPlayers = parseInt(pub.lgMaxPlayers || 10);
      lgRenderPlayers();
      // Init map if keys available in session
      lgGetKeysForGeneration().then(() => { if(LG.hasMapsKey()) lgInitMap(); });
    }
  } catch(e) { console.error(e); }
}

document.addEventListener('DOMContentLoaded', () => {
  avApplyPublicConfig();
});

</script>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADMIN LOGIN OVERLAY
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="admin2-login-overlay" id="admin2LoginOverlay">
  <div class="admin2-login-box">
    <div class="admin2-login-logo">AKAI VERITAS</div>
    <div class="admin2-login-sub">Admin Access â€” CEO Only</div>
    <div class="admin2-login-error" id="admin2LoginError">Incorrect password. Access denied.</div>
    <div class="admin2-lockout" id="admin2Lockout">ğŸ”’ Too many failed attempts. Try again in <span id="admin2LockTimer">15:00</span></div>
    <div class="form-group">
      <label class="form-label">Admin Password</label>
      <div style="position:relative;">
        <input type="password" class="form-input" id="admin2PwInput"
               placeholder="Enter admin password"
               onkeydown="if(event.key==='Enter')admin2Login()"
               autocomplete="off" style="padding-right:50px;"/>
        <button onclick="admin2TogglePw()" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:16px;" id="admin2PwEye">ğŸ‘</button>
      </div>
    </div>
    <button class="btn btn-primary" style="width:100%;justify-content:center;margin-top:8px;" onclick="admin2Login()">
      Authenticate
    </button>
    <button class="btn btn-secondary btn-sm" style="width:100%;justify-content:center;margin-top:12px;" onclick="admin2CloseLogin()">
      Cancel
    </button>
    <div style="margin-top:28px;padding-top:20px;border-top:1px solid var(--border);font-size:11px;color:var(--text-muted);text-align:center;line-height:1.7;">
      Protected by SHA-256 password hashing + AES encryption<br>
      Session expires on tab close Â· Max 5 attempts before lockout
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN ADMIN PANEL
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="admin2-panel" id="admin2Panel">
  <div class="admin2-header">
    <div class="admin2-header-left">
      <span class="admin2-logo">AKAI VERITAS</span>
      <span class="admin2-badge">CEO Admin Panel</span>
      <span id="admin2SessionLabel" style="font-size:12px;color:var(--text-muted);"></span>
    </div>
    <div style="display:flex;gap:10px;align-items:center;">
      <span id="admin2SaveAllMsg" style="font-size:12px;color:#4CAF50;display:none;">âœ“ All settings saved</span>
      <button class="btn btn-primary btn-sm" onclick="admin2SaveAll()">ğŸ’¾ Save All</button>
      <button class="btn btn-secondary btn-sm" onclick="admin2Logout()">ğŸ”’ Lock Panel</button>
    </div>
  </div>

  <div class="admin2-body">

    <!-- DASHBOARD STATS -->
    <div class="admin2-section-title">ğŸ“Š Dashboard</div>
    <div class="admin2-grid">
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ’° Revenue (30 days)</div>
        <div class="admin2-stat" id="a2StatRevenue">$0.00</div>
        <div class="admin2-stat-label">From delivered orders</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ® Kits Generated</div>
        <div class="admin2-stat" id="a2StatKits">0</div>
        <div class="admin2-stat-label">Total delivered</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ—ºï¸ Local Games</div>
        <div class="admin2-stat" id="a2StatLocal">0</div>
        <div class="admin2-stat-label">Generated this month</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">âš™ï¸ System Status</div>
        <table class="admin2-table">
          <tr><td>Stripe</td><td id="a2StripeStatus"><span class="admin2-status-pill warn">Not set</span></td></tr>
          <tr><td>PayPal</td><td id="a2PaypalStatus"><span class="admin2-status-pill warn">Not set</span></td></tr>
          <tr><td>Claude AI</td><td id="a2ClaudeStatus"><span class="admin2-status-pill warn">Not set</span></td></tr>
          <tr><td>Google Maps</td><td id="a2MapsStatus"><span class="admin2-status-pill warn">Not set</span></td></tr>
          <tr><td>Local Game</td><td id="a2LGStatus"><span class="admin2-status-pill warn">Disabled</span></td></tr>
        </table>
      </div>
    </div>

    <!-- API KEYS -->
    <div class="admin2-section-title">ğŸ”‘ API Keys & Integrations</div>
    <div style="background:rgba(139,32,32,0.08);border:1px solid rgba(139,32,32,0.2);border-radius:var(--radius);padding:14px 18px;margin-bottom:20px;font-size:13px;color:#C44040;">
      ğŸ”’ Keys are AES-256 encrypted in localStorage using your password as the encryption key. They are NEVER sent to any third party server other than the respective API provider.
    </div>
    <div class="admin2-grid">
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ’³ Stripe Secret Key</div>
        <div class="admin2-key-row">
          <input type="password" class="admin2-key-input" id="a2StripeKey" placeholder="sk_live_..." autocomplete="off"/>
          <button class="admin2-toggle-eye" onclick="admin2ToggleKey('a2StripeKey',this)">ğŸ‘</button>
        </div>
        <div class="admin2-key-status"><div class="admin2-dot" id="a2StripeDot" style="background:#5A5248"></div><span id="a2StripeMsg" style="color:var(--text-muted)">Not configured</span></div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Get from: dashboard.stripe.com â†’ Developers â†’ API keys</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ…¿ï¸ PayPal Client ID</div>
        <div class="admin2-key-row">
          <input type="password" class="admin2-key-input" id="a2PaypalKey" placeholder="AXxx..." autocomplete="off"/>
          <button class="admin2-toggle-eye" onclick="admin2ToggleKey('a2PaypalKey',this)">ğŸ‘</button>
        </div>
        <div class="admin2-key-status"><div class="admin2-dot" id="a2PaypalDot" style="background:#5A5248"></div><span id="a2PaypalMsg" style="color:var(--text-muted)">Not configured</span></div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Get from: developer.paypal.com â†’ My Apps</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ¤– Claude / OpenAI API Key</div>
        <div class="admin2-key-row">
          <input type="password" class="admin2-key-input" id="a2ClaudeKey" placeholder="sk-ant-... or sk-..." autocomplete="off"/>
          <button class="admin2-toggle-eye" onclick="admin2ToggleKey('a2ClaudeKey',this)">ğŸ‘</button>
        </div>
        <div class="admin2-key-status"><div class="admin2-dot" id="a2ClaudeDot" style="background:#5A5248"></div><span id="a2ClaudeMsg" style="color:var(--text-muted)">Not configured</span></div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Claude: console.anthropic.com Â· OpenAI: platform.openai.com</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ—ºï¸ Google Maps API Key</div>
        <div class="admin2-key-row">
          <input type="password" class="admin2-key-input" id="a2MapsKey" placeholder="AIzaSy..." autocomplete="off"/>
          <button class="admin2-toggle-eye" onclick="admin2ToggleKey('a2MapsKey',this)">ğŸ‘</button>
        </div>
        <div class="admin2-key-status"><div class="admin2-dot" id="a2MapsDot" style="background:#5A5248"></div><span id="a2MapsMsg" style="color:var(--text-muted)">Not configured</span></div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Needs: Maps JS API + Places API + Geocoding API</div>
      </div>
    </div>

    <!-- LOCAL GAME SETTINGS -->
    <div class="admin2-section-title">ğŸ—ºï¸ Local Game Settings</div>
    <div class="admin2-grid">
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ”› Enable / Disable</div>
        <div class="admin2-lgame-toggle">
          <label class="admin2-toggle-switch">
            <input type="checkbox" id="a2LGEnabled" onchange="admin2UpdateLGStatus()"/>
            <span class="admin2-toggle-slider"></span>
          </label>
          <div>
            <div style="font-size:14px;color:var(--text-primary);font-weight:600;">Local Game Section</div>
            <div style="font-size:12px;color:var(--text-muted);margin-top:2px;">Toggle visibility for visitors</div>
          </div>
        </div>
        <div style="margin-top:16px;">
          <label class="form-label">Game Price (â‚¬) â€” 0 = Free Beta</label>
          <input type="number" class="form-input" id="a2LGPrice" value="0" min="0" step="0.01" style="padding:12px 14px;"/>
        </div>
        <div style="margin-top:12px;">
          <label class="form-label">Max Players per Game</label>
          <input type="number" class="form-input" id="a2LGMaxPlayers" value="10" min="2" max="20" style="padding:12px 14px;"/>
        </div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ“‹ Local Game Stats</div>
        <table class="admin2-table">
          <tr><th>Metric</th><th>Value</th></tr>
          <tr><td>Games Generated</td><td id="a2LGGames" style="color:var(--gold);font-weight:600;">0</td></tr>
          <tr><td>Locations Used</td><td id="a2LGLocations" style="color:var(--gold);">0</td></tr>
          <tr><td>Status</td><td id="a2LGStatusCell"><span class="admin2-status-pill warn">Disabled</span></td></tr>
        </table>
      </div>
    </div>

    <!-- BUSINESS SETTINGS -->
    <div class="admin2-section-title">ğŸ¢ Business Settings</div>
    <div class="admin2-grid">
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸ“§ Business Email</div>
        <input type="email" class="form-input" id="a2BusinessEmail" placeholder="hello@akaiveritas.com" style="padding:12px 14px;margin-top:4px;"/>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Used for order notifications and customer support</div>
      </div>
      <div class="admin2-card">
        <div class="admin2-card-title">ğŸŒ Domain</div>
        <input type="text" class="form-input" id="a2Domain" placeholder="akaiveritas.com" style="padding:12px 14px;margin-top:4px;"/>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Your live domain for share links and og:url</div>
      </div>
    </div>

    <!-- CHANGE PASSWORD -->
    <div class="admin2-section-title">ğŸ” Security</div>
    <div class="admin2-card" style="max-width:520px;">
      <div class="admin2-card-title">Change Admin Password</div>
      <div class="admin2-pw-change">
        <div class="form-group" style="margin-bottom:12px;">
          <label class="form-label">Current Password</label>
          <input type="password" class="form-input" id="a2PwCurrent" autocomplete="off" style="padding:12px 14px;"/>
        </div>
        <div class="form-group" style="margin-bottom:12px;">
          <label class="form-label">New Password (min. 12 characters)</label>
          <input type="password" class="form-input" id="a2PwNew" autocomplete="off" style="padding:12px 14px;"/>
        </div>
        <div class="form-group" style="margin-bottom:16px;">
          <label class="form-label">Confirm New Password</label>
          <input type="password" class="form-input" id="a2PwConfirm" autocomplete="off" style="padding:12px 14px;"/>
        </div>
        <button class="btn btn-primary btn-sm" onclick="admin2ChangePassword()">Update Password</button>
        <span id="a2PwMsg" style="font-size:12px;margin-left:12px;"></span>
      </div>
      <div class="admin2-danger-zone" style="margin-top:20px;">
        <div class="admin2-danger-title">âš ï¸ Danger Zone</div>
        <button class="btn btn-sm" style="background:rgba(139,32,32,0.2);border:1px solid rgba(139,32,32,0.4);color:#C44040;" onclick="admin2ClearAll()">
          ğŸ—‘ï¸ Clear All Stored Data
        </button>
        <div style="font-size:12px;color:var(--text-muted);margin-top:8px;">Removes all keys, orders and settings from localStorage. Irreversible.</div>
      </div>
    </div>

    <!-- RECENT ORDERS -->
    <div class="admin2-section-title">ğŸ“¦ Recent Orders</div>
    <div class="admin2-card">
      <div id="a2OrdersTable">
        <div style="font-size:14px;color:var(--text-muted);padding:20px 0;text-align:center;">No orders yet</div>
      </div>
    </div>

  </div><!-- end admin2-body -->
</div><!-- end admin2-panel -->

</body>
</html>
